/*******************************************************************************
*              (c), Copyright 2001, Marvell International Ltd.                 *
* THIS CODE CONTAINS CONFIDENTIAL INFORMATION OF MARVELL SEMICONDUCTOR, INC.   *
* NO RIGHTS ARE GRANTED HEREIN UNDER ANY PATENT, MASK WORK RIGHT OR COPYRIGHT  *
* OF MARVELL OR ANY THIRD PARTY. MARVELL RESERVES THE RIGHT AT ITS SOLE        *
* DISCRETION TO REQUEST THAT THIS CODE BE IMMEDIATELY RETURNED TO MARVELL.     *
* THIS CODE IS PROVIDED "AS IS". MARVELL MAKES NO WARRANTIES, EXPRESSED,       *
* IMPLIED OR OTHERWISE, REGARDING ITS ACCURACY, COMPLETENESS OR PERFORMANCE.   *
********************************************************************************
* prvCpssDxChPortIfModeCfgBobkResource.c
*
* DESCRIPTION:
*       CPSS BobK implementation for Port interface mode resource configuration.
*
*
* FILE REVISION NUMBER:
*       $Revision: 1 $
*******************************************************************************/
#include <cpss/dxCh/dxChxGen/config/private/prvCpssDxChInfo.h>
#include <cpss/dxCh/dxChxGen/cpssHwInit/private/prvCpssDxChHwInit.h>
#include <cpss/dxCh/dxChxGen/port/cpssDxChPortCtrl.h>
#include <cpss/dxCh/dxChxGen/port/cpssDxChPortInterlaken.h>
#include <cpss/dxCh/dxChxGen/port/PortMapping/prvCpssDxChPortMappingShadowDB.h>
#include <cpss/dxCh/dxChxGen/port/private/prvCpssDxChPortCtrl.h>
#include <cpss/dxCh/dxChxGen/port/private/prvCpssDxChPortIfModeCfgBcat2Resource.h>
#include <cpss/dxCh/dxChxGen/port/private/prvCpssDxChPortIfModeCfgBobKResource.h>
#include <cpss/dxCh/dxChxGen/port/private/prvCpssDxChPortIfModeCfgResource.h>


#define PRV_CPSS_DXCH_CAELUM_DP0_TXQ_CREDITS_CNS                144
#define PRV_CPSS_DXCH_CAELUM_DP1_TXQ_CREDITS_CNS                144

#define PRV_CPSS_DXCH_CAELUM_DP0_TXFIFO_HEADERS_CREDITS_CNS     276
#define PRV_CPSS_DXCH_CAELUM_DP1_TXFIFO_HEADERS_CREDITS_CNS     363

#define PRV_CPSS_DXCH_CAELUM_DP0_TXFIFO_PAYLOAD_CREDITS_CNS     387
#define PRV_CPSS_DXCH_CAELUM_DP1_TXFIFO_PAYLOAD_CREDITS_CNS     447

#define PRV_CPSS_DXCH_CETUS_DP1_TXQ_CREDITS_CNS                 144
#define PRV_CPSS_DXCH_CETUS_DP1_TXFIFO_HEADERS_CREDITS_CNS      363
#define PRV_CPSS_DXCH_CETUS_DP1_TXFIFO_PAYLOAD_CREDITS_CNS      447

#define PRV_CPSS_DXCH_BOBK_DP1_FIRST_PORT_NUM_CNS 48




/*-----------------------------------------------------------------------------------*
 * TXDMA_SCDMA_TxQDescriptorCredit : core clock (MHz) x  speed (Mbps)
 *-----------------------------------------------------------------------------------*/
GT_U32 prvCpssDxChBobkTxdmaScdmaTxQDescriptorCreditCore0Arr[5][3] = 
{ 
     {      0, 1000, 2500 }
    ,{    167,    3,    4 }
    ,{    200,    3,    4 }
    ,{    250,    3,    4 }
    ,{    365,    2,    3 }
}; 


GT_U32 prvCpssDxChBobkTxdmaScdmaTxQDescriptorCreditCore1Arr[5][13] = 
{ 
     {   0, 1000, 2500, 10000, 12000, 13000, 20000, 24000, 25000, 40000, 48000, 49000, 75000 }
    ,{ 167,    3,    5,    13,    12,    12,    23,    21,    22,    42,    40,    40,    60 }
    ,{ 200,    3,    5,    13,    12,    12,    21,    20,    20,    38,    35,    36,    52 }
    ,{ 250,    3,    5,    11,    10,    10,    18,    16,    16,    30,    28,    29,    43 }
    ,{ 365,    3,    4,     9,     8,     8,    14,    13,    13,    23,    21,    21,    30 }
}; 

/*-----------------------------------------------------------------------------------*
 * TXDMA_SCDMA_TxFIFOHeaderCreditThreshold : core clock (MHz) x  speed (Mbps)
 *-----------------------------------------------------------------------------------*/
GT_U32 prvCpssDxChBobkTxdmaScdmaTxFifoHeaderCreditThresholdCore1Arr[5][13] = 
{ 
     {   0, 1000, 2500, 10000, 12000, 13000, 20000, 24000, 25000, 40000, 48000, 49000, 75000 }
    ,{ 167,    5,   10,    47,    45,    46,    93,    90,    91,   184,   178,   180,   278 }
    ,{ 200,    4,    9,    39,    38,    39,    78,    76,    76,   155,   149,   151,   233 }
    ,{ 250,    3,    7,    31,    30,    31,    62,    61,    61,   124,   119,   121,   187 }
    ,{ 365,    3,    6,    22,    22,    22,    43,    42,    42,    84,    83,    83,   129 }
};

/*-----------------------------------------------------------------------------------*
 * TXDMA_SCDMA_TxFIFOPayloadCreditThreshold : core clock (MHz) x  speed (Mbps)
 *-----------------------------------------------------------------------------------*/
GT_U32 prvCpssDxChBobkTxdmaScdmaTxFifoPayloadCreditThresholdCore1Arr[5][13] = 
{ 
     {   0, 1000, 2500, 10000, 12000, 13000, 20000, 24000, 25000, 40000, 48000, 49000, 75000 }
    ,{ 167,    7,   13,    53,    51,     0,   103,     0,     0,   202,   199,     0,     0 }
    ,{ 200,    6,   11,    44,    44,     0,    86,     0,     0,   170,   167,     0,     0 }
    ,{ 250,    5,    9,    35,    35,     0,    69,     0,     0,   136,   134,     0,     0 }
    ,{ 365,    5,    8,    25,    26,     0,    48,     0,     0,    93,    93,     0,     0 }
}; 

/*-----------------------------------------------------------------------------------*
 * TXFIFO_SCDMA_PayloadStartTransmThreshold : core clock (MHz) x  speed (Mbps)
 *-----------------------------------------------------------------------------------*/
GT_U32 prvCpssDxChBobkTxFifoScdmaPayloadThresholdCore1Arr[5][13] = 
{ 
     {   0, 1000, 2500, 10000, 12000, 13000, 20000, 24000, 25000, 40000, 48000, 49000, 75000 }
    ,{ 167,    2,    3,     6,     6,     0,    10,     0,     0,    18,    21,     0,     0 }
    ,{ 200,    2,    2,     5,     6,     0,     8,     0,     0,    15,    18,     0,     0 }
    ,{ 250,    2,    2,     4,     5,     0,     7,     0,     0,    12,    15,     0,     0 }
    ,{ 365,    2,    2,     3,     4,     0,     5,     0,     0,     9,    10,     0,     0 }
}; 


GT_U32 ipgBytesArr[2][13] = 
{
     { 0, 1000, 2500, 10000, 12000, 13000, 20000, 24000, 25000, 40000, 48000, 49000, 75000 }
    ,{ 0,   20 ,  20,     4,    20,    20,     4,    20,    20,     4,    20,    20,    20 }
};

GT_U32 maxBwArr[5][3] = 
{ 
     {   0,    1,    2 }
    ,{ 167,   48,   67 }
    ,{ 200,   48,  101 }
    ,{ 250,   48,  121 }
    ,{ 365,   48,  185 }
}; 

GT_U32 prvCpssDxChBobkWorstCaseAck2AckDiffCore0Arr[5][3] = 
{ 
     {      0, 1000, 2500 }
    ,{    167,   48,   20 }
    ,{    200,   48,   20 }
    ,{    250,   48,   20 }
    ,{    365,   48,   20 }
}; 

GT_U32 prvCpssDxChBobkWorstCaseAck2AckDiffCore1Arr[5][13] = 
{ 
     {   0, 1000, 2500, 10000, 12000, 13000, 20000, 24000, 25000, 40000, 48000, 49000, 75000 }
    ,{ 167,   67,   36,    10,     8,     7,     5,     4,     4,     3,     2,     2,     1 }
    ,{ 200,  101,   56,    16,    13,    12,     9,     8,     7,     5,     4,     4,     2 }
    ,{ 250,  121,   66,    19,    15,    14,    10,     8,     7,     5,     4,     4,     3 }
    ,{ 365,  185,   99,    28,    23,    21,    15,    13,    12,     8,     6,     6,     4 }
}; 



/**************************************************************************************
*
*    TM port resource part
*
**************************************************************************************/

/*-----------------------------------------------------------------------------------*
 * TXDMA_SCDMA_TxQDescriptorCredit : core clock (MHz) x  speed (Mbps)
 *-----------------------------------------------------------------------------------*/
GT_U32 prvCpssDxChBobkTxdmaScdmaTxQDescriptorCreditTmArr[5][186] = 
{ 
     {      0,   1000,   2000,   3000,   4000,   5000,   6000,   7000,   8000,   9000,  10000,  11000,  12000,  13000,  14000,  15000,  16000,  17000,  18000,  19000,  20000,  21000,  22000,  23000,  24000,  25000,  26000,  27000,  28000,  29000,  30000,  31000,  32000,  33000,  34000,  35000,  36000,  37000,  38000,  39000,  40000,  41000,  42000,  43000,  44000,  45000,  46000,  47000,  48000,  49000,  50000,  51000,  52000,  53000,  54000,  55000,  56000,  57000,  58000,  59000,  60000,  61000,  62000,  63000,  64000,  65000,  66000,  67000,  68000,  69000,  70000,  71000,  72000,  73000,  74000,  75000,  76000,  77000,  78000,  79000,  80000,  81000,  82000,  83000,  84000,  85000,  86000,  87000,  88000,  89000,  90000,  91000,  92000,  93000,  94000,  95000,  96000,  97000,  98000,  99000, 100000, 101000, 102000, 103000, 104000, 105000, 106000, 107000, 108000, 109000, 110000, 111000, 112000, 113000, 114000, 115000, 116000, 117000, 118000, 119000, 120000, 121000, 122000, 123000, 124000, 125000, 126000, 127000, 128000, 129000, 130000, 131000, 132000, 133000, 134000, 135000, 136000, 137000, 138000, 139000, 140000, 141000, 142000, 143000, 144000, 145000, 146000, 147000, 148000, 149000, 150000, 151000, 152000, 153000, 154000, 155000, 156000, 157000, 158000, 159000, 160000, 161000, 162000, 163000, 164000, 165000, 166000, 167000, 168000, 169000, 170000, 171000, 172000, 173000, 174000, 175000, 176000, 177000, 178000, 179000, 180000, 181000, 182000, 183000, 184000, 185000 }
    ,{    167,      3,      4,      6,      6,      7,      8,      9,     10,     10,     13,     12,     12,     13,     14,     15,     16,     17,     17,     18,     23,     20,     20,     21,     21,     22,     23,     24,     25,     26,     27,     28,     28,     28,     29,     30,     31,     32,     33,     34,     42,     35,     36,     37,     37,     37,     38,     39,     40,     41,     41,     42,     43,     44,     45,     46,     46,     47,     48,     49,     50,     51,     51,     52,     53,     54,     55,     54,     53,     53,     54,     55,     56,     56,     57,     58,     59,     60,     60,     61,     62,     63,     63,     64,     65,     66,     66,     67,     68,     69,     69,     70,     71,     72,     73,     73,     74,     75,     76,     76,     77,     78,     79,     79,     80,     81,     82,     82,     83,     84,     85,     86,     86,     87,     88,     89,     89,     90,     91,     92,     92,     93,     94,     95,     96,     96,     97,     98,     99,     99,    100,    101,    102,    102,    103,    104,    105,    105,    106,    107,    108,    109,    109,    110,    111,    112,    112,    113,    114,    115,    115,    116,    117,    118,    119,    119,    120,    121,    122,    122,    123,    124,    125,    125,    126,    127,    128,    128,    129,    130,    131,    132,    132,    133,    134,    135,    135,    136,    137,    138,    138,    139,    140,    141,    142,    142 }
    ,{    200,      3,      5,      6,      6,      7,      8,      9,      9,     10,     13,     11,     12,     12,     13,     14,     15,     15,     16,     16,     21,     18,     19,     19,     20,     20,     21,     21,     22,     23,     24,     24,     25,     25,     26,     27,     28,     28,     29,     29,     38,     30,     31,     32,     33,     33,     34,     35,     35,     36,     36,     37,     37,     38,     39,     39,     40,     41,     41,     42,     43,     44,     44,     45,     46,     46,     47,     46,     47,     48,     48,     49,     50,     50,     51,     52,     53,     53,     54,     55,     55,     56,     57,     57,     58,     59,     59,     60,     61,     61,     62,     63,     63,     64,     65,     66,     66,     67,     68,     68,     69,     67,     66,     66,     67,     68,     68,     69,     70,     70,     71,     72,     72,     73,     73,     74,     75,     75,     76,     77,     77,     78,     79,     79,     80,     80,     81,     82,     82,     83,     84,     84,     85,     86,     86,     87,     88,     88,     89,     89,     90,     91,     91,     92,     93,     93,     94,     95,     95,     96,     96,     97,     98,     98,     99,    100,    100,    101,    102,    102,    103,    104,    104,    105,    105,    106,    107,    107,    108,    109,    109,    110,    111,    111,    112,    112,    113,    114,    114,    115,    116,    116,    117,    118,    118,    119 }
    ,{    250,      3,      5,      6,      6,      6,      7,      7,      8,      9,     11,     10,     10,     10,     11,     12,     12,     13,     13,     14,     18,     15,     15,     16,     16,     16,     18,     18,     18,     19,     20,     20,     21,     22,     22,     22,     23,     23,     24,     24,     30,     25,     26,     26,     27,     28,     28,     29,     28,     29,     30,     30,     31,     31,     32,     33,     33,     34,     34,     34,     34,     35,     36,     36,     37,     37,     38,     38,     39,     40,     40,     41,     41,     42,     42,     43,     43,     44,     45,     45,     44,     45,     45,     46,     46,     47,     48,     48,     49,     49,     50,     50,     51,     51,     52,     53,     53,     54,     54,     55,     55,     56,     56,     57,     57,     58,     59,     59,     60,     60,     61,     61,     62,     62,     63,     63,     64,     65,     65,     66,     66,     65,     63,     63,     64,     64,     65,     66,     66,     67,     67,     68,     68,     69,     69,     70,     70,     71,     71,     72,     72,     73,     73,     74,     74,     75,     75,     76,     76,     77,     77,     78,     78,     79,     79,     80,     80,     81,     81,     82,     82,     83,     83,     84,     84,     85,     85,     86,     86,     87,     88,     88,     89,     89,     90,     90,     91,     91,     92,     92,     93,     93,     94,     94,     95,     95 }
    ,{    365,      3,      4,      5,      5,      6,      6,      6,      7,      7,      9,      8,      8,      8,      9,      9,     10,     10,     11,     11,     14,     12,     12,     13,     13,     13,     14,     14,     14,     15,     15,     15,     16,     16,     17,     17,     17,     18,     18,     18,     23,     19,     19,     20,     20,     20,     21,     21,     21,     21,     22,     22,     23,     23,     23,     24,     24,     25,     25,     26,     25,     26,     26,     26,     27,     27,     28,     28,     29,     29,     29,     30,     30,     31,     30,     30,     31,     31,     32,     32,     32,     33,     33,     34,     34,     34,     35,     35,     36,     36,     35,     36,     36,     37,     37,     37,     38,     38,     38,     39,     39,     40,     40,     40,     41,     41,     42,     42,     42,     43,     43,     43,     44,     44,     45,     45,     45,     46,     46,     47,     47,     47,     48,     47,     47,     47,     48,     48,     49,     49,     49,     50,     50,     50,     51,     51,     52,     52,     52,     53,     53,     53,     54,     54,     55,     55,     55,     56,     56,     56,     57,     57,     58,     58,     58,     59,     59,     59,     60,     60,     61,     61,     61,     62,     62,     62,     63,     63,     64,     64,     64,     65,     65,     65,     66,     66,     67,     67,     67,     68,     68,     68,     69,     69,     70,     68 }
}; 


/*-----------------------------------------------------------------------------------*
 * TXDMA_SCDMA_TxFIFOHeaderCreditThreshold : core clock (MHz) x  speed (Mbps)
 *-----------------------------------------------------------------------------------*/
GT_U32 prvCpssDxChBobkTxdmaScdmaTxFifoHeaderCreditThresholdTmArr[5][186] = 
{ 
     {      0,   1000,   2000,   3000,   4000,   5000,   6000,   7000,   8000,   9000,  10000,  11000,  12000,  13000,  14000,  15000,  16000,  17000,  18000,  19000,  20000,  21000,  22000,  23000,  24000,  25000,  26000,  27000,  28000,  29000,  30000,  31000,  32000,  33000,  34000,  35000,  36000,  37000,  38000,  39000,  40000,  41000,  42000,  43000,  44000,  45000,  46000,  47000,  48000,  49000,  50000,  51000,  52000,  53000,  54000,  55000,  56000,  57000,  58000,  59000,  60000,  61000,  62000,  63000,  64000,  65000,  66000,  67000,  68000,  69000,  70000,  71000,  72000,  73000,  74000,  75000,  76000,  77000,  78000,  79000,  80000,  81000,  82000,  83000,  84000,  85000,  86000,  87000,  88000,  89000,  90000,  91000,  92000,  93000,  94000,  95000,  96000,  97000,  98000,  99000, 100000, 101000, 102000, 103000, 104000, 105000, 106000, 107000, 108000, 109000, 110000, 111000, 112000, 113000, 114000, 115000, 116000, 117000, 118000, 119000, 120000, 121000, 122000, 123000, 124000, 125000, 126000, 127000, 128000, 129000, 130000, 131000, 132000, 133000, 134000, 135000, 136000, 137000, 138000, 139000, 140000, 141000, 142000, 143000, 144000, 145000, 146000, 147000, 148000, 149000, 150000, 151000, 152000, 153000, 154000, 155000, 156000, 157000, 158000, 159000, 160000, 161000, 162000, 163000, 164000, 165000, 166000, 167000, 168000, 169000, 170000, 171000, 172000, 173000, 174000, 175000, 176000, 177000, 178000, 179000, 180000, 181000, 182000, 183000, 184000, 185000 }
    ,{    167,      5,      9,     12,     16,     19,     24,     27,     30,     34,     47,     42,     45,     49,     52,     56,     60,     64,     68,     72,     93,     79,     83,     87,     89,     93,     97,    101,    104,    108,    112,    115,    119,    123,    127,    131,    134,    138,    142,    145,    184,    153,    157,    160,    164,    167,    171,    175,    178,    182,    186,    190,    193,    197,    201,    204,    208,    212,    216,    219,    223,    227,    230,    234,    238,    242,    245,    249,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0 }
    ,{    200,      4,      7,     10,     13,     17,     20,     23,     25,     28,     39,     35,     38,     41,     44,     47,     50,     54,     57,     60,     78,     65,     69,     72,     75,     79,     82,     85,     88,     91,     94,     97,    100,    104,    107,    110,    113,    116,    119,    121,    155,    127,    130,    134,    137,    140,    143,    146,    149,    152,    156,    159,    162,    165,    168,    171,    174,    177,    180,    184,    187,    190,    193,    196,    199,    202,    205,    208,    211,    214,    217,    220,    223,    226,    230,    233,    236,    239,    242,    245,    248,    251,    254,    257,    260,    264,    267,    270,    273,    276,    279,    282,    285,    288,    291,    295,    298,    301,    304,    307,    310,    313,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0 }
    ,{    250,      3,      5,      9,     11,     14,     15,     18,     21,     24,     31,     29,     30,     33,     35,     38,     40,     43,     45,     48,     62,     53,     56,     58,     60,     63,     65,     67,     70,     73,     75,     78,     80,     83,     85,     88,     90,     93,     95,     98,    124,    103,    105,    108,    110,    113,    115,    118,    119,    122,    124,    127,    129,    132,    134,    137,    139,    142,    144,    147,    149,    152,    154,    157,    159,    162,    164,    167,    169,    172,    174,    177,    179,    182,    184,    187,    189,    192,    194,    197,    199,    201,    204,    206,    208,    211,    213,    216,    218,    221,    223,    226,    228,    231,    233,    236,    238,    241,    243,    246,    248,    251,    253,    256,    258,    260,    263,    265,    268,    270,    273,    275,    278,    280,    283,    285,    288,    290,    293,    295,    298,    300,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0 }
    ,{    365,      3,      5,      7,      8,     10,     11,     13,     15,     16,     22,     19,     22,     23,     24,     26,     28,     30,     32,     33,     43,     36,     38,     40,     41,     43,     45,     47,     48,     50,     52,     54,     55,     57,     59,     61,     63,     64,     65,     67,     84,     70,     72,     73,     76,     78,     79,     81,     83,     84,     86,     88,     90,     91,     93,     95,     96,     98,    100,    102,    103,    105,    107,    108,    110,    112,    114,    115,    117,    119,    120,    122,    124,    126,    126,    128,    129,    131,    133,    135,    136,    138,    140,    141,    143,    145,    146,    148,    150,    151,    154,    155,    157,    159,    160,    162,    164,    165,    167,    169,    171,    172,    174,    176,    177,    179,    181,    182,    184,    186,    188,    189,    191,    193,    194,    196,    198,    200,    201,    203,    205,    206,    208,    209,    211,    213,    214,    216,    218,    219,    221,    223,    224,    226,    228,    230,    231,    233,    235,    236,    238,    240,    241,    243,    245,    246,    248,    250,    252,    253,    255,    257,    258,    260,    262,    263,    265,    267,    269,    270,    272,    274,    275,    277,    279,    280,    282,    284,    285,    287,    289,    291,    292,    294,    296,    297,    299,    301,    302,    304,    306,    308,    309,    311,    313,    314 }
}; 


/*-----------------------------------------------------------------------------------*
 * TXDMA_SCDMA_TxFIFOPayloadCreditThreshold : core clock (MHz) x  speed (Mbps)
 *-----------------------------------------------------------------------------------*/
GT_U32 prvCpssDxChBobkTxdmaScdmaTxFifoPayloadCreditThresholdTmArr[5][186] = 
{ 
     {      0,   1000,   2000,   3000,   4000,   5000,   6000,   7000,   8000,   9000,  10000,  11000,  12000,  13000,  14000,  15000,  16000,  17000,  18000,  19000,  20000,  21000,  22000,  23000,  24000,  25000,  26000,  27000,  28000,  29000,  30000,  31000,  32000,  33000,  34000,  35000,  36000,  37000,  38000,  39000,  40000,  41000,  42000,  43000,  44000,  45000,  46000,  47000,  48000,  49000,  50000,  51000,  52000,  53000,  54000,  55000,  56000,  57000,  58000,  59000,  60000,  61000,  62000,  63000,  64000,  65000,  66000,  67000,  68000,  69000,  70000,  71000,  72000,  73000,  74000,  75000,  76000,  77000,  78000,  79000,  80000,  81000,  82000,  83000,  84000,  85000,  86000,  87000,  88000,  89000,  90000,  91000,  92000,  93000,  94000,  95000,  96000,  97000,  98000,  99000, 100000, 101000, 102000, 103000, 104000, 105000, 106000, 107000, 108000, 109000, 110000, 111000, 112000, 113000, 114000, 115000, 116000, 117000, 118000, 119000, 120000, 121000, 122000, 123000, 124000, 125000, 126000, 127000, 128000, 129000, 130000, 131000, 132000, 133000, 134000, 135000, 136000, 137000, 138000, 139000, 140000, 141000, 142000, 143000, 144000, 145000, 146000, 147000, 148000, 149000, 150000, 151000, 152000, 153000, 154000, 155000, 156000, 157000, 158000, 159000, 160000, 161000, 162000, 163000, 164000, 165000, 166000, 167000, 168000, 169000, 170000, 171000, 172000, 173000, 174000, 175000, 176000, 177000, 178000, 179000, 180000, 181000, 182000, 183000, 184000, 185000 }
    ,{    167,      7,     11,     15,     19,     23,     28,     31,     35,     39,     53,     48,     51,     56,     59,     64,     68,     72,     77,     81,    103,     89,     94,     98,    100,    105,    109,    114,    117,    121,    126,    129,    134,    138,    142,    147,    150,    155,    159,    162,    202,    171,    176,    179,    184,    187,    191,    196,    199,    204,    208,    212,    216,    220,    225,    228,    232,    237,    241,    245,    249,    254,    257,    261,    266,    270,    274,    278,     29,     30,     30,     31,     31,     31,     32,     32,     33,     33,     33,     34,     34,     35,     35,     36,     36,     36,     37,     37,     38,     38,     38,     39,     39,     40,     40,     40,     41,     41,     42,     42,     43,     43,     43,     44,     44,     45,     45,     45,     46,     46,     47,     47,     47,     48,     48,     49,     49,     49,     50,     50,     51,     51,     52,     52,     52,     53,     53,     54,     54,     54,     55,     55,     56,     56,     56,     57,     57,     58,     58,     59,     59,     59,     60,     60,     61,     61,     61,     62,     62,     63,     63,     63,     64,     64,     65,     65,     65,     66,     66,     67,     67,     68,     68,     68,     69,     69,     70,     70,     70,     71,     71,     72,     72,     72,     73,     73,     74,     74,     75,     75,     75,     76,     76,     77,     77,     77 }
    ,{    200,      6,      9,     13,     16,     20,     24,     27,     29,     33,     44,     40,     44,     47,     50,     54,     57,     61,     65,     68,     86,     74,     78,     81,     85,     89,     92,     96,     99,    102,    106,    109,    112,    117,    120,    123,    127,    130,    133,    136,    170,    143,    146,    150,    154,    157,    160,    164,    167,    170,    175,    178,    181,    185,    188,    191,    195,    198,    201,    206,    209,    212,    216,    219,    222,    226,    229,    232,    236,    239,    242,    246,    249,    252,    257,    260,    263,    267,    270,    274,    277,    280,    284,    287,    290,    295,    298,    301,    305,    308,    311,    315,    318,    321,    325,    329,    332,    336,    339,    342,    346,    349,     36,     37,     37,     37,     38,     38,     38,     39,     39,     39,     40,     40,     40,     41,     41,     41,     42,     42,     43,     43,     43,     44,     44,     44,     45,     45,     45,     46,     46,     46,     47,     47,     47,     48,     48,     48,     49,     49,     49,     50,     50,     50,     51,     51,     51,     52,     52,     52,     53,     53,     53,     54,     54,     54,     55,     55,     56,     56,     56,     57,     57,     57,     58,     58,     58,     59,     59,     59,     60,     60,     60,     61,     61,     61,     62,     62,     62,     63,     63,     63,     64,     64,     64,     65 }
    ,{    250,      5,      7,     11,     14,     17,     18,     21,     25,     28,     35,     34,     35,     38,     40,     44,     46,     49,     51,     55,     69,     60,     64,     66,     68,     71,     74,     76,     79,     82,     85,     88,     90,     94,     96,     99,    101,    105,    107,    110,    136,    116,    118,    121,    124,    127,    129,    132,    134,    137,    139,    142,    145,    148,    150,    154,    156,    159,    161,    165,    167,    170,    172,    176,    178,    181,    184,    187,    189,    192,    195,    198,    200,    203,    206,    209,    211,    215,    217,    220,    222,    225,    228,    230,    232,    236,    238,    241,    244,    247,    249,    252,    255,    258,    260,    263,    266,    269,    271,    275,    277,    280,    282,    286,    288,    290,    293,    296,    299,    301,    305,    307,    310,    312,    316,    318,    321,    323,    327,    329,    332,    335,     35,     35,     35,     36,     36,     36,     36,     37,     37,     37,     38,     38,     38,     38,     39,     39,     39,     40,     40,     40,     40,     41,     41,     41,     41,     42,     42,     42,     43,     43,     43,     43,     44,     44,     44,     44,     45,     45,     45,     46,     46,     46,     46,     47,     47,     47,     47,     48,     48,     48,     49,     49,     49,     49,     50,     50,     50,     50,     51,     51,     51,     52,     52,     52 }
    ,{    365,      5,      7,      9,     10,     12,     14,     16,     18,     19,     25,     23,     26,     27,     28,     30,     32,     35,     37,     38,     48,     41,     44,     46,     47,     49,     51,     54,     55,     57,     59,     61,     62,     65,     67,     69,     71,     72,     74,     76,     93,     79,     81,     83,     86,     88,     89,     91,     93,     95,     97,     99,    101,    102,    105,    107,    108,    110,    112,    115,    116,    118,    120,    121,    123,    126,    128,    129,    131,    133,    135,    137,    139,    141,    141,    144,    145,    147,    149,    151,    152,    155,    157,    158,    160,    162,    164,    166,    168,    169,    172,    174,    176,    178,    179,    181,    183,    185,    187,    189,    191,    192,    195,    197,    198,    200,    202,    204,    206,    208,    210,    211,    213,    216,    217,    219,    221,    223,    225,    227,    229,    230,    232,    234,    236,    238,    239,    241,    243,    245,    247,    249,    250,    252,    255,    257,    258,    260,    262,    264,    266,    268,    269,    271,    273,    275,    277,    279,    281,    282,    285,    287,    288,    290,    292,    294,    296,    298,    300,    301,    303,    306,    307,    309,    311,    312,    315,    317,    318,    320,    322,    325,    326,    328,    330,    331,    333,    336,    337,    339,    341,    343,    345,    347,    349,    350 }
}; 


/*-----------------------------------------------------------------------------------*
 * TXFIFO_SCDMA_PayloadStartTransmThreshold : core clock (MHz) x  speed (Mbps)
 *-----------------------------------------------------------------------------------*/
GT_U32 prvCpssDxChBobkTxFifoScdmaPayloadThresholdTmArr[5][186] = 
{ 
     {      0,   1000,   2000,   3000,   4000,   5000,   6000,   7000,   8000,   9000,  10000,  11000,  12000,  13000,  14000,  15000,  16000,  17000,  18000,  19000,  20000,  21000,  22000,  23000,  24000,  25000,  26000,  27000,  28000,  29000,  30000,  31000,  32000,  33000,  34000,  35000,  36000,  37000,  38000,  39000,  40000,  41000,  42000,  43000,  44000,  45000,  46000,  47000,  48000,  49000,  50000,  51000,  52000,  53000,  54000,  55000,  56000,  57000,  58000,  59000,  60000,  61000,  62000,  63000,  64000,  65000,  66000,  67000,  68000,  69000,  70000,  71000,  72000,  73000,  74000,  75000,  76000,  77000,  78000,  79000,  80000,  81000,  82000,  83000,  84000,  85000,  86000,  87000,  88000,  89000,  90000,  91000,  92000,  93000,  94000,  95000,  96000,  97000,  98000,  99000, 100000, 101000, 102000, 103000, 104000, 105000, 106000, 107000, 108000, 109000, 110000, 111000, 112000, 113000, 114000, 115000, 116000, 117000, 118000, 119000, 120000, 121000, 122000, 123000, 124000, 125000, 126000, 127000, 128000, 129000, 130000, 131000, 132000, 133000, 134000, 135000, 136000, 137000, 138000, 139000, 140000, 141000, 142000, 143000, 144000, 145000, 146000, 147000, 148000, 149000, 150000, 151000, 152000, 153000, 154000, 155000, 156000, 157000, 158000, 159000, 160000, 161000, 162000, 163000, 164000, 165000, 166000, 167000, 168000, 169000, 170000, 171000, 172000, 173000, 174000, 175000, 176000, 177000, 178000, 179000, 180000, 181000, 182000, 183000, 184000, 185000 }
    ,{    167,      2,      2,      3,      3,      4,      4,      4,      5,      5,      6,      6,      6,      7,      7,      8,      8,      8,      9,      9,     10,     10,     11,     11,     11,     12,     12,     13,     13,     13,     14,     14,     15,     15,     15,     16,     16,     17,     17,     17,     18,     18,     19,     19,     20,     20,     20,     21,     21,     22,     22,     22,     23,     23,     24,     24,     24,     25,     25,     26,     26,     27,     27,     27,     28,     28,     29,     29,     29,     30,     30,     31,     31,     31,     32,     32,     33,     33,     33,     34,     34,     35,     35,     36,     36,     36,     37,     37,     38,     38,     38,     39,     39,     40,     40,     40,     41,     41,     42,     42,     43,     43,     43,     44,     44,     45,     45,     45,     46,     46,     47,     47,     47,     48,     48,     49,     49,     49,     50,     50,     51,     51,     52,     52,     52,     53,     53,     54,     54,     54,     55,     55,     56,     56,     56,     57,     57,     58,     58,     59,     59,     59,     60,     60,     61,     61,     61,     62,     62,     63,     63,     63,     64,     64,     65,     65,     65,     66,     66,     67,     67,     68,     68,     68,     69,     69,     70,     70,     70,     71,     71,     72,     72,     72,     73,     73,     74,     74,     75,     75,     75,     76,     76,     77,     77,     77 }
    ,{    200,      2,      2,      3,      3,      3,      4,      4,      4,      5,      5,      5,      6,      6,      6,      7,      7,      7,      8,      8,      8,      9,      9,      9,     10,     10,     10,     11,     11,     11,     12,     12,     12,     13,     13,     13,     14,     14,     14,     15,     15,     16,     16,     16,     17,     17,     17,     18,     18,     18,     19,     19,     19,     20,     20,     20,     21,     21,     21,     22,     22,     22,     23,     23,     23,     24,     24,     24,     25,     25,     25,     26,     26,     26,     27,     27,     27,     28,     28,     29,     29,     29,     30,     30,     30,     31,     31,     31,     32,     32,     32,     33,     33,     33,     34,     34,     34,     35,     35,     35,     36,     36,     36,     37,     37,     37,     38,     38,     38,     39,     39,     39,     40,     40,     40,     41,     41,     41,     42,     42,     43,     43,     43,     44,     44,     44,     45,     45,     45,     46,     46,     46,     47,     47,     47,     48,     48,     48,     49,     49,     49,     50,     50,     50,     51,     51,     51,     52,     52,     52,     53,     53,     53,     54,     54,     54,     55,     55,     56,     56,     56,     57,     57,     57,     58,     58,     58,     59,     59,     59,     60,     60,     60,     61,     61,     61,     62,     62,     62,     63,     63,     63,     64,     64,     64,     65 }
    ,{    250,      2,      2,      2,      3,      3,      3,      3,      4,      4,      4,      5,      5,      5,      5,      6,      6,      6,      6,      7,      7,      7,      8,      8,      8,      8,      9,      9,      9,      9,     10,     10,     10,     11,     11,     11,     11,     12,     12,     12,     12,     13,     13,     13,     14,     14,     14,     14,     15,     15,     15,     15,     16,     16,     16,     17,     17,     17,     17,     18,     18,     18,     18,     19,     19,     19,     20,     20,     20,     20,     21,     21,     21,     21,     22,     22,     22,     23,     23,     23,     23,     24,     24,     24,     24,     25,     25,     25,     26,     26,     26,     26,     27,     27,     27,     27,     28,     28,     28,     29,     29,     29,     29,     30,     30,     30,     30,     31,     31,     31,     32,     32,     32,     32,     33,     33,     33,     33,     34,     34,     34,     35,     35,     35,     35,     36,     36,     36,     36,     37,     37,     37,     38,     38,     38,     38,     39,     39,     39,     40,     40,     40,     40,     41,     41,     41,     41,     42,     42,     42,     43,     43,     43,     43,     44,     44,     44,     44,     45,     45,     45,     46,     46,     46,     46,     47,     47,     47,     47,     48,     48,     48,     49,     49,     49,     49,     50,     50,     50,     50,     51,     51,     51,     52,     52,     52 }
    ,{    365,      2,      2,      2,      2,      2,      3,      3,      3,      3,      3,      4,      4,      4,      4,      4,      4,      5,      5,      5,      5,      5,      6,      6,      6,      6,      6,      7,      7,      7,      7,      7,      7,      8,      8,      8,      8,      8,      9,      9,      9,      9,      9,     10,     10,     10,     10,     10,     10,     11,     11,     11,     11,     11,     12,     12,     12,     12,     12,     13,     13,     13,     13,     13,     13,     14,     14,     14,     14,     14,     15,     15,     15,     15,     15,     16,     16,     16,     16,     16,     16,     17,     17,     17,     17,     17,     18,     18,     18,     18,     18,     19,     19,     19,     19,     19,     19,     20,     20,     20,     20,     20,     21,     21,     21,     21,     21,     22,     22,     22,     22,     22,     22,     23,     23,     23,     23,     23,     24,     24,     24,     24,     24,     25,     25,     25,     25,     25,     25,     26,     26,     26,     26,     26,     27,     27,     27,     27,     27,     28,     28,     28,     28,     28,     28,     29,     29,     29,     29,     29,     30,     30,     30,     30,     30,     31,     31,     31,     31,     31,     31,     32,     32,     32,     32,     32,     33,     33,     33,     33,     33,     34,     34,     34,     34,     34,     34,     35,     35,     35,     35,     35,     36,     36,     36,     36 }
}; 

/*******************************************************************************
* prvCpssDxChCaelumPortResourcesSpeedIndexGet
*
* DESCRIPTION:
*       Gets speed index in database
*
* APPLICABLE DEVICES:
*       Caelum.
*
* NOT APPLICABLE DEVICES:
*       DxCh1; DxCh1_Diamond; DxCh2; DxCh3; xCat; xCat3; Lion; xCat2; Lion2; Bobcat2; Bobcat3. 
*
*
* INPUTS:
*       speed       - port interface speed
*
* OUTPUTS:
*       speedIndexPtr - (pointer to) speed DB
*       speedValuePtr - (pointer to) speed value in Mbps
*
* RETURNS:
*       GT_OK                    - on success
*       GT_BAD_PARAM             - on wrong speed
*       GT_NOT_APPLICABLE_DEVICE - on not applicable device
*
* COMMENTS:
*
*******************************************************************************/
static GT_STATUS prvCpssDxChCaelumPortResourcesSpeedIndexGet
(
    IN  CPSS_PORT_SPEED_ENT  speed,
    OUT GT_U32               *speedIndexPtr,
    OUT GT_U32               *speedValuePtr
)
{
    CPSS_NULL_PTR_CHECK_MAC(speedIndexPtr);
    CPSS_NULL_PTR_CHECK_MAC(speedValuePtr);

    switch(speed)
    {
        case CPSS_PORT_SPEED_1000_E:
            *speedIndexPtr = 1;
            *speedValuePtr = 1000;
            break;
        case CPSS_PORT_SPEED_2500_E:
            *speedIndexPtr = 2;
            *speedValuePtr = 2500;
            break;
        case CPSS_PORT_SPEED_10000_E:
            *speedIndexPtr = 3;
            *speedValuePtr = 10000;
            break;
        case CPSS_PORT_SPEED_11800_E:
            *speedIndexPtr = 4;
            *speedValuePtr = 12000;
            break;
        case CPSS_PORT_SPEED_20000_E:
            *speedIndexPtr = 6;
            *speedValuePtr = 20000;
            break;
        case CPSS_PORT_SPEED_40000_E:
            *speedIndexPtr = 9;
            *speedValuePtr = 40000;
            break;
        case CPSS_PORT_SPEED_47200_E:
            *speedIndexPtr = 10;
            *speedValuePtr = 48000;
            break;
        default:
            return GT_BAD_PARAM;
    }

    return GT_OK;
}


/*******************************************************************************
* prvCpssDxChCaelumPortResourcesClockIndexGet
*
* DESCRIPTION:
*       Gets core clock index in database
*
* APPLICABLE DEVICES:
*       Caelum.
*
* NOT APPLICABLE DEVICES:
*       DxCh1; DxCh1_Diamond; DxCh2; DxCh3; xCat; xCat3; Lion; xCat2; Lion2; Bobcat2; Bobcat3. 
*
*
* INPUTS:
*       coreClock     - device core clock
*
* OUTPUTS:
*       speedIndexPtr - (pointer to) core clock DB
*
* RETURNS:
*       GT_OK                    - on success
*       GT_BAD_PARAM             - on wrong clock
*       GT_NOT_APPLICABLE_DEVICE - on not applicable device
*
* COMMENTS:
*
*******************************************************************************/
static GT_STATUS prvCpssDxChCaelumPortResourcesClockIndexGet
(
    IN  GT_U32  coreClock,
    OUT GT_U32  *clockIndexPtr
)
{
    CPSS_NULL_PTR_CHECK_MAC(clockIndexPtr);

    switch(coreClock)
    {
        case 167:
            *clockIndexPtr = 1;
            break;
        case 200:
            *clockIndexPtr = 2;
            break;
        case 250:
            *clockIndexPtr = 3;
            break;
        case 365:
            *clockIndexPtr = 4;
            break;
        default:
            return GT_BAD_PARAM;
    }

    return GT_OK;
}

/*******************************************************************************
* prvCpssDxChCaelumPortResourcesCalculation
*
* DESCRIPTION:
*       Caelum port new resourse calculations
*
* APPLICABLE DEVICES:
*       Caelum.
*
* NOT APPLICABLE DEVICES:
*       DxCh1; DxCh1_Diamond; DxCh2; DxCh3; xCat; xCat3; Lion; xCat2; Lion2; Bobcat2; Bobcat3.
*
*
* INPUTS:
*       devNum      - physical device number
*       portNum     - physical port number
*       ifMode      - port interface mode
*       speed       - port interface speed
*
* OUTPUTS:
*       None.
*
* RETURNS:
*       GT_OK                    - on success
*       GT_BAD_PARAM             - on wrong port number, device, ifMode, speed
*       GT_HW_ERROR              - on hardware error
*       GT_NOT_APPLICABLE_DEVICE - on not applicable device
*
* COMMENTS:
*
*******************************************************************************/
GT_STATUS prvCpssDxChCaelumPortResourcesCalculation
(
    IN  GT_U8                           devNum,
    IN  GT_PHYSICAL_PORT_NUM            portNum,
    IN  CPSS_PORT_SPEED_ENT             speed,
    OUT GT_U32                          *txdmaCreditValuePtr,
    OUT GT_U32                          *txfifoHeaderCounterThresholdScdmaPtr,
    OUT GT_U32                          *txfifoPayloadCounterThresholdScdmaPtr
)
{
    GT_STATUS   rc;                     /* return code */
    GT_U32      speedIndex;             /* index in speed DB */
    GT_U32      coreClockIndex;         /* index in clock DB */
    GT_U32      txdmaCreditValue;       /* TXDMA desscriptor credit number */
    GT_U32      mppmMinLatency=64;      /* MPPM minimum latency */
    GT_U32      perBankFifoSize=35;     /* per bank FIFO size */
    GT_U32      othersLatencyCore0=301; /* other latency DP_0 */
    GT_U32      othersLatencyCore1=281; /* other latency DP_1 */
    GT_U32      othersLatency;          /* other latency */
    GT_U32      worstCaseAck2AckDiff;   /* ACK to ACK diff per speed per core clock */
#if 0
    GT_U32      ipgBytes;               /* IPG value per speed */
#endif
    GT_U32      osBw;                   /* OS bandwidth per core clock */
    float       transmitTime64BC;
    GT_U32      mppmMaxLatency;         /* MPPM maximum latency */
    GT_U32      maxLatency;             /* maximum latency */
    GT_U32      speedValueMbps;
    GT_U32      headerCounterThreshold;
    GT_U32      payloadCounterThreshold;
    GT_U32      mppmLatencyVariance;
    float       minThresholdForTransmission;
    GT_U32      coreClock;
    GT_U32      sumPortSpeed;

    CPSS_NULL_PTR_CHECK_MAC(txdmaCreditValuePtr);
    CPSS_NULL_PTR_CHECK_MAC(txfifoHeaderCounterThresholdScdmaPtr);
    CPSS_NULL_PTR_CHECK_MAC(txfifoPayloadCounterThresholdScdmaPtr);

    rc = prvCpssDxChCaelumPortResourcesSpeedIndexGet(speed, &speedIndex, &speedValueMbps);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDxChCaelumPortResourcesClockIndexGet(PRV_CPSS_PP_MAC(devNum)->coreClock, &coreClockIndex);
    if(GT_OK != rc)
    {
        return rc;
    }

    /*
        1. TXDMA desc credits – each DMA, according to its speed, requires a certain amount of descriptors
           allocated space inside the TXDMA to be able to support FWS (desc_credits_scdma%p).

        TXDMA 0
        Register:   <TXDMA0_IP> TxDMA IP Units/TxDMA Per SCDMA Configurations/FIFOs Thresholds Configurations SCDMA %p Reg 1
        Fields:     BITS 0-8: Descriptor Credits SCDMA %p
        Limitation: SUM(DescriptorCreditsScdma_cc {PortSpeed,CoreFreq}) <= 144

        TXDMA 1
        Register:   <TXDMA1_IP> TxDMA IP Units/TxDMA Per SCDMA Configurations/FIFOs Thresholds Configurations SCDMA %p Reg 1
        Fields:     BITS 0-8: Descriptor Credits SCDMA %p
        Limitation: SUM(DescriptorCreditsScdma_cc {PortSpeed,CoreFreq}) <= 144

    */
    if(portNum < 48)
    {
        txdmaCreditValue = prvCpssDxChBobkTxdmaScdmaTxQDescriptorCreditCore0Arr[coreClockIndex][speedIndex];
        sumPortSpeed = PRV_CPSS_DXCH_PP_MAC(devNum)->portGroupsExtraInfo.groupResorcesStatus.coreOverallSpeedSummary[0];
        othersLatency  = othersLatencyCore0;
        worstCaseAck2AckDiff = prvCpssDxChBobkWorstCaseAck2AckDiffCore0Arr[coreClockIndex][speedIndex];
    }
    else
    {
        txdmaCreditValue = prvCpssDxChBobkTxdmaScdmaTxQDescriptorCreditCore1Arr[coreClockIndex][speedIndex];
        sumPortSpeed = PRV_CPSS_DXCH_PP_MAC(devNum)->portGroupsExtraInfo.groupResorcesStatus.coreOverallSpeedSummary[1];
        othersLatency  = othersLatencyCore1;
        worstCaseAck2AckDiff = prvCpssDxChBobkWorstCaseAck2AckDiffCore1Arr[coreClockIndex][speedIndex];
    }

    *txdmaCreditValuePtr = txdmaCreditValue;


    /*
        2. TXFIFO header and payload credits – each DMA, according to its speed, 
           requires a certain amount of space allocated inside the TXDMA for both 
           headers and payload to achieve FWS and avoid under-runs 

        TXDMA 0     
        Register:   <TXDMA0_IP> TxDMA IP Units/TxDMA Per SCDMA Configurations/TxFIFO Counters Configurations SCDMA %p
        Fields:     BITS 0-9: TxFIFO Header Counter Threshold SCDMA %p
                    BITS 10-19: TxFIFO Payload Counter Threshold SCDMA %p
        Limitation: SUM(Header {PortSpeed,CoreFreq}) <= 276
                    SUM(Payload {PortSpeed,CoreFreq}) <= 387

        TXDMA 1
        Register:   <TXDMA1_IP> TxDMA IP Units/TxDMA Per SCDMA Configurations/TxFIFO Counters Configurations SCDMA %p
        Fields:     BITS 0-9: TxFIFO Header Counter Threshold SCDMA %p
                    BITS 10-19: TxFIFO Payload Counter Threshold SCDMA %p
        Limitation: SUM(Header {PortSpeed,CoreFreq}) <= 363
                    SUM(Payload {PortSpeed,CoreFreq}) <= 447

    */

    transmitTime64BC = (float)(((64+ipgBytesArr[1][speedIndex]) * 8 ) / (speedValueMbps / 1000));

    osBw = maxBwArr[coreClockIndex][2];
    /* in order to roundup result of (A / B) the following seq. should be done:  ((A + B - 1) / B) */
    mppmMaxLatency = mppmMinLatency + (((perBankFifoSize*osBw*2)+(speedValueMbps + sumPortSpeed)/1000 - 1)/((speedValueMbps + sumPortSpeed)/1000));

    maxLatency = ((mppmMaxLatency + othersLatency + worstCaseAck2AckDiff) - ((mppmMaxLatency + othersLatency + worstCaseAck2AckDiff)%worstCaseAck2AckDiff)) * 1000;
    /* round up (maxLatency / coreClock) */
    maxLatency = (maxLatency + PRV_CPSS_PP_MAC(devNum)->coreClock - 1) / PRV_CPSS_PP_MAC(devNum)->coreClock;

    /* round up (maxLatency / transmitTime64BC) */
    headerCounterThreshold = (maxLatency + (GT_U32)transmitTime64BC - 1) / ((GT_U32)transmitTime64BC);
    *txfifoHeaderCounterThresholdScdmaPtr = headerCounterThreshold;

    mppmLatencyVariance = mppmMaxLatency - mppmMinLatency;

    coreClock = PRV_CPSS_PP_MAC(devNum)->coreClock;

    minThresholdForTransmission = (((float)mppmLatencyVariance / (float)coreClock) + ((float)(2 * osBw)/(float)(speedValueMbps*coreClock/1000)))*speedValueMbps;
    /* round up minThresholdForTransmission / 1024*/
    minThresholdForTransmission = (minThresholdForTransmission + 1024 - 1) / 1024;
    payloadCounterThreshold = headerCounterThreshold + (GT_U32)minThresholdForTransmission;
    *txfifoPayloadCounterThresholdScdmaPtr = payloadCounterThreshold;

    /*
        3. Payload Threshold – to avoid under-runs due to variance in the 
           latency of read responses from the MPPM – the TXFIFO is required
           to start transmitting the packet only after reaching a certain
           threshold. Each DMA speeds require a different threshold
           (scdma_%p_payload_threshold).
    */
    

    return GT_OK;
}

/*******************************************************************************
* prvCpssDxChCaelumPortResourcesCalculation
*
* DESCRIPTION:
*       Caelum port new resourse calculations
*
* APPLICABLE DEVICES:
*       Caelum.
*
* NOT APPLICABLE DEVICES:
*       DxCh1; DxCh1_Diamond; DxCh2; DxCh3; xCat; xCat3; Lion; xCat2; Lion2; Bobcat2; Bobcat3.
*
*
* INPUTS:
*       devNum      - physical device number
*       portNum     - physical port number
*       ifMode      - port interface mode
*       speed       - port interface speed
*
* OUTPUTS:
*       None.
*
* RETURNS:
*       GT_OK                    - on success
*       GT_BAD_PARAM             - on wrong port number, device, ifMode, speed
*       GT_HW_ERROR              - on hardware error
*       GT_NOT_APPLICABLE_DEVICE - on not applicable device
*
* COMMENTS:
*
*******************************************************************************/
GT_STATUS prvCpssDxChCaelumPortResourcesLimitationCheck
(
    IN GT_U8                           devNum,
    IN GT_PHYSICAL_PORT_NUM            portNum,
    IN CPSS_PORT_INTERFACE_MODE_ENT    ifMode,
    IN CPSS_PORT_SPEED_ENT             speed
)
{
    devNum = devNum;
    portNum = portNum;
    ifMode = ifMode;
    speed = speed;

    return GT_OK;
}

/*******************************************************************************
* prvCpssDxChCaelumPortResourcesConfigDynamic
*
* DESCRIPTION:
*       Caelum port resourse dynamic configuration
*
* APPLICABLE DEVICES:
*       Caelum.
*
* NOT APPLICABLE DEVICES:
*       DxCh1; DxCh1_Diamond; DxCh2; DxCh3; xCat; xCat3; Lion; xCat2; Lion2; Bobcat2; Bobcat3.
*
*
* INPUTS:
*       devNum      - physical device number
*       portNum     - physical port number
*       ifMode      - port interface mode
*       speed       - port interface speed
*
* OUTPUTS:
*       None.
*
* RETURNS:
*       GT_OK                    - on success
*       GT_BAD_PARAM             - on wrong port number, device, ifMode, speed
*       GT_HW_ERROR              - on hardware error
*       GT_NOT_APPLICABLE_DEVICE - on not applicable device
*
* COMMENTS:
*
*******************************************************************************/
GT_STATUS prvCpssDxChCaelumPortResourcesConfigDynamic
(
    IN GT_U8                           devNum,
    IN GT_PHYSICAL_PORT_NUM            portNum,
    IN CPSS_PORT_INTERFACE_MODE_ENT    ifMode,
    IN CPSS_PORT_SPEED_ENT             speed
)
{
    devNum = devNum;
    portNum = portNum;
    ifMode = ifMode;
    speed = speed;

    return GT_OK;
}

/*******************************************************************************
* prvCpssDxChCaelumTmPortResourseConfigSet
*
* DESCRIPTION:
*       Set resources allocated to the TM port
*
* APPLICABLE DEVICES:
*       Caelum.
*
* NOT APPLICABLE DEVICES:
*       DxCh1; DxCh1_Diamond; DxCh2; DxCh3; xCat; xCat3; Lion; xCat2; Lion2; Bobcat2.
*
* INPUTS:
*       devNum    - physical device number
*       portNum   - physical port number
*
* OUTPUTS:
*       None
*
* RETURNS:
*       GT_OK             - on success
*       GT_BAD_PARAM      - on wrong port number or device
*       GT_HW_ERROR       - on hardware error
*       GT_NOT_SUPPORTED  - on not supported interface for given port
*       GT_NOT_APPLICABLE_DEVICE - on not applicable device
*
* COMMENTS:
*
*******************************************************************************/
GT_STATUS prvCpssDxChCaelumTmPortResourseConfigSet
(
    IN GT_U8                                        devNum,
    IN GT_PHYSICAL_PORT_NUM                         portNum,
    IN PRV_CPSS_DXCH_CAELUM_PORT_TM_RESOURCE_STC    *resourcePtr
)
{
    GT_STATUS   rc;
    GT_U32      regAddr;
    GT_U32      fieldOffset;
    GT_U32      fieldLen;
    PRV_CPSS_DXCH_PORT_MAP_SHADOW_STC *portMapShadowPtr;

    /* 1. TxDMA 73(TM) - TxQ Credits */
    rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                         PRV_CAELUM_REG_FIELDS_TXDMA_DESC_CREDITS_SCDMA_E,
                                         &regAddr, &fieldOffset, &fieldLen);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDrvHwPpSetRegField(devNum, regAddr, fieldOffset, fieldLen, resourcePtr->txdmaCreditValue);
    if(GT_OK != rc)
    {
        return rc;
    }

    /* 2. TxDMA 73(TM) - TxFIFO Header threshold */
    rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                         PRV_CAELUM_REG_FIELDS_TXDMA_SCDMA_TXFIFO_HEADER_THRESHOLD_E,
                                         &regAddr, &fieldOffset, &fieldLen);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDrvHwPpSetRegField(devNum, regAddr, fieldOffset, fieldLen, resourcePtr->txfifoHeaderCounterThresholdScdma);
    if(GT_OK != rc)
    {
        return rc;
    }

    /* 3. TxDMA 73(TM) - TxFIFO Payload threshold */
    rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                         PRV_CAELUM_REG_FIELDS_TXDMA_SCDMA_TXFIFO_PAYLOAD_THRESHOLD_E,
                                         &regAddr, &fieldOffset, &fieldLen);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDrvHwPpSetRegField(devNum, regAddr, fieldOffset, fieldLen, resourcePtr->txfifoPayloadCounterThresholdScdma);
    if(GT_OK != rc)
    {
        return rc;
    }

    /* 4. TxFIFO 73(TM) - SCDMA Payload threshold */
    rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                         PRV_CAELUM_REG_FIELDS_TXFIFO_SCDMA_PAYLOAD_THRESHOLD_E,
                                         &regAddr, &fieldOffset, &fieldLen);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDrvHwPpSetRegField(devNum, regAddr, fieldOffset, fieldLen, resourcePtr->txfifoScdmaPayloadThreshold);
    if(GT_OK != rc)
    {
        return rc;
    }

    /* 5. TxFIFO 73(TM) - TXFIFO Outgoing Bus Width */
    rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                         PRV_CAELUM_REG_FIELDS_TXFIFO_SCDMA_SHIFTERS_OUTGOING_BUS_WIDTH_E,
                                         &regAddr, &fieldOffset, &fieldLen);
    if(GT_OK != rc)
    {
        return rc;
    }

    /* 6. Tx FIFO TM port (73) is always use 512 bit width, static*/
    rc = prvCpssDrvHwPpSetRegField(devNum, regAddr, fieldOffset, fieldLen, resourcePtr->txfifoScdmaShiftersOutgoingBusWidth);
    if(GT_OK != rc)
    {
        return rc;
    }

    /* 7. RxDMA (port_X) - RxDMA IF_WIDTH */
    rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                         PRV_CAELUM_REG_FIELDS_RXDMA_SCDMA_INCOMING_BUS_WIDTH_E,
                                         &regAddr, &fieldOffset, &fieldLen);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDrvHwPpSetRegField(devNum, regAddr, fieldOffset, fieldLen, resourcePtr->rxdmaScdmaIncomingBusWidth);
    if(GT_OK != rc)
    {
        return rc;
    }


    /* Get Port Mapping DataBase */
    rc = prvCpssDxChPortPhysicalPortMapShadowDBGet(devNum, portNum, /*OUT*/&portMapShadowPtr);
    if(rc != GT_OK)
    {
        return rc;
    }

    if(portMapShadowPtr->portMap.trafficManagerEn == GT_TRUE)
    {
        /* 8. Eth-TXFIFO IF width */
        rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                             PRV_CAELUM_REG_FIELDS_ETH_TXFIFO_OUTGOING_BUS_WIDTH_E,
                                             &regAddr, &fieldOffset, &fieldLen);
        if(GT_OK != rc)
        {
            return rc;
        }

        rc = prvCpssDrvHwPpSetRegField(devNum, regAddr, fieldOffset, fieldLen, resourcePtr->ethTxfifoOutgoingBusWidth);
        if(GT_OK != rc)
        {
            return rc;
        }


        /* 9. Eth-TXFIFO Payload StartTrasmThreshold */
        rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                             PRV_CAELUM_REG_FIELDS_ETH_TXFIFO_SCDMA_PAYLOAD_THRESHOLD_E,
                                             &regAddr, &fieldOffset, &fieldLen);
        if(GT_OK != rc)
        {
            return rc;
        }

        rc = prvCpssDrvHwPpSetRegField(devNum, regAddr, fieldOffset, fieldLen, resourcePtr->ethTxfifoScdmaPayloadThreshold);
        if(GT_OK != rc)
        {
            return rc;
        }

    }

    return GT_OK;
}


/*******************************************************************************
* prvCpssDxChCaelumTmPortResourseConfigGet
*
* DESCRIPTION:
*       Get resources allocated to the TM port
*
* APPLICABLE DEVICES:
*       Caelum.
*
* NOT APPLICABLE DEVICES:
*       DxCh1; DxCh1_Diamond; DxCh2; DxCh3; xCat; xCat3; Lion; xCat2; Lion2; Bobcat2.
*
* INPUTS:
*       devNum    - physical device number
*       portNum   - physical port number
*
* OUTPUTS:
*       None
*
* RETURNS:
*       GT_OK             - on success
*       GT_BAD_PARAM      - on wrong port number or device
*       GT_HW_ERROR       - on hardware error
*       GT_NOT_SUPPORTED  - on not supported interface for given port
*       GT_NOT_APPLICABLE_DEVICE - on not applicable device
*
* COMMENTS:
*
*******************************************************************************/
GT_STATUS prvCpssDxChCaelumTmPortResourseConfigGet
(
    IN  GT_U8                                        devNum,
    IN  GT_PHYSICAL_PORT_NUM                         portNum,
    OUT PRV_CPSS_DXCH_CAELUM_PORT_TM_RESOURCE_STC    *resourcePtr
)
{
    GT_STATUS   rc;
    GT_U32      regAddr;
    GT_U32      fieldOffset;
    GT_U32      fieldLen;
    PRV_CPSS_DXCH_PORT_MAP_SHADOW_STC *portMapShadowPtr;

    cpssOsMemSet(resourcePtr, 0, sizeof(resourcePtr));

    /* 1. TxDMA 73(TM) - TxQ Credits */
    rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                         PRV_CAELUM_REG_FIELDS_TXDMA_DESC_CREDITS_SCDMA_E,
                                         &regAddr, &fieldOffset, &fieldLen);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDrvHwPpGetRegField(devNum, regAddr, fieldOffset, fieldLen, &resourcePtr->txdmaCreditValue);
    if(GT_OK != rc)
    {
        return rc;
    }

    /* 2. TxDMA 73(TM) - TxFIFO Header threshold */
    rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                         PRV_CAELUM_REG_FIELDS_TXDMA_SCDMA_TXFIFO_HEADER_THRESHOLD_E,
                                         &regAddr, &fieldOffset, &fieldLen);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDrvHwPpGetRegField(devNum, regAddr, fieldOffset, fieldLen, &resourcePtr->txfifoHeaderCounterThresholdScdma);
    if(GT_OK != rc)
    {
        return rc;
    }

    /* 3. TxDMA 73(TM) - TxFIFO Payload threshold */
    rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                         PRV_CAELUM_REG_FIELDS_TXDMA_SCDMA_TXFIFO_PAYLOAD_THRESHOLD_E,
                                         &regAddr, &fieldOffset, &fieldLen);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDrvHwPpGetRegField(devNum, regAddr, fieldOffset, fieldLen, &resourcePtr->txfifoPayloadCounterThresholdScdma);
    if(GT_OK != rc)
    {
        return rc;
    }

    /* 4. TxFIFO 73(TM) - SCDMA Payload threshold */
    rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                         PRV_CAELUM_REG_FIELDS_TXFIFO_SCDMA_PAYLOAD_THRESHOLD_E,
                                         &regAddr, &fieldOffset, &fieldLen);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDrvHwPpGetRegField(devNum, regAddr, fieldOffset, fieldLen, &resourcePtr->txfifoScdmaPayloadThreshold);
    if(GT_OK != rc)
    {
        return rc;
    }

    /* 5. TxFIFO 73(TM) - TXFIFO Outgoing Bus Width */
    rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                         PRV_CAELUM_REG_FIELDS_TXFIFO_SCDMA_SHIFTERS_OUTGOING_BUS_WIDTH_E,
                                         &regAddr, &fieldOffset, &fieldLen);
    if(GT_OK != rc)
    {
        return rc;
    }

        /*Tx FIFO TM port (73) is always use 512 bit width, static*/
    rc = prvCpssDrvHwPpGetRegField(devNum, regAddr, fieldOffset, fieldLen, &resourcePtr->txfifoScdmaShiftersOutgoingBusWidth);
    if(GT_OK != rc)
    {
        return rc;
    }

    /* RxDMA (port_X) - RxDMA IF_WIDTH */
    rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                         PRV_CAELUM_REG_FIELDS_RXDMA_SCDMA_INCOMING_BUS_WIDTH_E,
                                         &regAddr, &fieldOffset, &fieldLen);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDrvHwPpGetRegField(devNum, regAddr, fieldOffset, fieldLen, &resourcePtr->rxdmaScdmaIncomingBusWidth);
    if(rc != GT_OK)
    {
        return rc;
    }

    /* Get Port Mapping DataBase */
    rc = prvCpssDxChPortPhysicalPortMapShadowDBGet(devNum, portNum, /*OUT*/&portMapShadowPtr);
    if(rc != GT_OK)
    {
        return rc;
    }

    if(portMapShadowPtr->portMap.trafficManagerEn == GT_TRUE)
    {
        /* 8. Eth-TXFIFO IF width */
        rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                             PRV_CAELUM_REG_FIELDS_ETH_TXFIFO_OUTGOING_BUS_WIDTH_E,
                                             &regAddr, &fieldOffset, &fieldLen);
        if(GT_OK != rc)
        {
            return rc;
        }

        rc = prvCpssDrvHwPpGetRegField(devNum, regAddr, fieldOffset, fieldLen, &resourcePtr->ethTxfifoOutgoingBusWidth);
        if(GT_OK != rc)
        {
            return rc;
        }


        /* 9. Eth-TXFIFO Payload StartTrasmThreshold */
        rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                             PRV_CAELUM_REG_FIELDS_ETH_TXFIFO_SCDMA_PAYLOAD_THRESHOLD_E,
                                             &regAddr, &fieldOffset, &fieldLen);
        if(GT_OK != rc)
        {
            return rc;
        }

        rc = prvCpssDrvHwPpGetRegField(devNum, regAddr, fieldOffset, fieldLen, &resourcePtr->ethTxfifoScdmaPayloadThreshold);
        if(GT_OK != rc)
        {
            return rc;
        }

    }

    return GT_OK;
}

/*******************************************************************************
* prvCpssDxChCaelumPortResourcesConfigStatic
*
* DESCRIPTION:
*       Cetus port resourse static configuration
*
* APPLICABLE DEVICES:
*       Caelum.
*
* NOT APPLICABLE DEVICES:
*       DxCh1; DxCh1_Diamond; DxCh2; DxCh3; xCat; xCat3; Lion; xCat2; Lion2; Bobcat2; Bobcat3.
*
*
* INPUTS:
*       devNum      - physical device number
*       portNum     - physical port number
*       ifMode      - port interface mode
*       speed       - port interface speed
*
* OUTPUTS:
*       None.
*
* RETURNS:
*       GT_OK                    - on success
*       GT_BAD_PARAM             - on wrong port number, device, ifMode, speed
*       GT_HW_ERROR              - on hardware error
*       GT_NOT_APPLICABLE_DEVICE - on not applicable device
*
* COMMENTS:
*
*******************************************************************************/
static GT_STATUS prvCpssDxChCaelumPortResourcesConfigStatic
(
    IN GT_U8                           devNum,
    IN GT_PHYSICAL_PORT_NUM            portNum,
    IN CPSS_PORT_INTERFACE_MODE_ENT    ifMode,
    IN CPSS_PORT_SPEED_ENT             speed
)
{
    GT_STATUS   rc, rc1;            /* return code */
    GT_U32      regAddr;            /* register value */
    GT_U32      fieldOffset;        /* register field offset */
    GT_U32      fieldLen;           /* register field length */
    GT_U32      txdmaCreditValue;   /* TXDMA desscriptor credit number */
    GT_U32      txfifoHeaderCounterThresholdScdma;
    GT_U32      txfifoPayloadCounterThresholdScdma;
    GT_U32      txfifoScdmaPayloadThreshold;
    GT_U32      txfifoScdmaShiftersOutgoingBusWidth;
    GT_U32      rxdmaScdmaIncomingBusWidth;
    GT_U32      speedValueMbps;
    GT_U32      speedIndex;         /* index in speed DB */
    GT_U32      coreClockIndex;     /* index in clock DB */
    PRV_CPSS_DXCH_PORT_MAP_SHADOW_STC *portMapShadowPtr;
    GT_U32      dpIndexTxDma;
    GT_U32      newTmBwMbps;
    PRV_CPSS_DXCH_CAELUM_PORT_TM_RESOURCE_STC newTmResource;
    PRV_CPSS_DXCH_CAELUM_PORT_TM_RESOURCE_STC currTmResource;

    ifMode = ifMode;
    cpssOsMemSet(&newTmResource, 0, sizeof(newTmResource));
    cpssOsMemSet(&currTmResource, 0, sizeof(currTmResource));

    /* Get Port Mapping DataBase */
    rc = prvCpssDxChPortPhysicalPortMapShadowDBGet(devNum, portNum, /*OUT*/&portMapShadowPtr);
    if(rc != GT_OK)
    {
        return rc;
    }

    dpIndexTxDma = portMapShadowPtr->portMap.txDmaNum >= PRV_CPSS_DXCH_BOBK_DP1_FIRST_PORT_NUM_CNS;

    /* convert port speed to DB index and speed value in Mbps */
    rc = prvCpssDxChCaelumPortResourcesSpeedIndexGet(speed, &speedIndex, &speedValueMbps);
    if(GT_OK != rc)
    {
        return rc;
    }

    /* convert core clock to DB index */
    rc = prvCpssDxChCaelumPortResourcesClockIndexGet(PRV_CPSS_PP_MAC(devNum)->coreClock, &coreClockIndex);
    if(GT_OK != rc)
    {
        return rc;
    }

    switch(speed)
    {
        case CPSS_PORT_SPEED_10_E:
        case CPSS_PORT_SPEED_100_E:
        case CPSS_PORT_SPEED_1000_E:
            txfifoScdmaShiftersOutgoingBusWidth = PRV_CPSS_TxFIFO_OutGoungBusWidth_1B_E;
            rxdmaScdmaIncomingBusWidth = PRV_CPSS_RXDMA_IfWidth_64_E;
            break;

        case CPSS_PORT_SPEED_10000_E:
        case CPSS_PORT_SPEED_12000_E:
        case CPSS_PORT_SPEED_11800_E:
        case CPSS_PORT_SPEED_2500_E:
            txfifoScdmaShiftersOutgoingBusWidth = PRV_CPSS_TxFIFO_OutGoungBusWidth_8B_E;
            rxdmaScdmaIncomingBusWidth = PRV_CPSS_RXDMA_IfWidth_64_E;
            break;

        case CPSS_PORT_SPEED_20000_E:
        case CPSS_PORT_SPEED_40000_E:
        case CPSS_PORT_SPEED_47200_E:
            txfifoScdmaShiftersOutgoingBusWidth = PRV_CPSS_TxFIFO_OutGoungBusWidth_32B_E;
            rxdmaScdmaIncomingBusWidth = PRV_CPSS_RXDMA_IfWidth_256_E;
            break;

        case CPSS_PORT_SPEED_75000_E:
            txfifoScdmaShiftersOutgoingBusWidth = PRV_CPSS_TxFIFO_OutGoungBusWidth_64B_E;
            rxdmaScdmaIncomingBusWidth = PRV_CPSS_RXDMA_IfWidth_512_E;
            break;

        default:
            return GT_BAD_PARAM;
    }
    /*--------------------------------------------------------------------*
     *  correct for CPU txFifo-outgoing bus width DMA 72 has width 8Bytes *
     *--------------------------------------------------------------------*/
    if (portMapShadowPtr->portMap.mappingType == CPSS_DXCH_PORT_MAPPING_TYPE_CPU_SDMA_E) 
    {
        txfifoScdmaShiftersOutgoingBusWidth = PRV_CPSS_TxFIFO_OutGoungBusWidth_8B_E;  
    }

    if(portMapShadowPtr->portMap.trafficManagerEn == GT_FALSE)
    {
        txdmaCreditValue                   = prvCpssDxChBobkTxdmaScdmaTxQDescriptorCreditCore1Arr         [coreClockIndex][speedIndex];
        txfifoHeaderCounterThresholdScdma  = prvCpssDxChBobkTxdmaScdmaTxFifoHeaderCreditThresholdCore1Arr [coreClockIndex][speedIndex];
        txfifoPayloadCounterThresholdScdma = prvCpssDxChBobkTxdmaScdmaTxFifoPayloadCreditThresholdCore1Arr[coreClockIndex][speedIndex];
        txfifoScdmaPayloadThreshold        = prvCpssDxChBobkTxFifoScdmaPayloadThresholdCore1Arr           [coreClockIndex][speedIndex];
    }
    else
    {
        if(PRV_CPSS_DXCH_PP_MAC(devNum)->portGroupsExtraInfo.groupResorcesStatus.trafficManagerCumBWMbps != 0)
        {
            rc = prvCpssDxChCaelumTmPortResourseConfigGet(devNum, portNum, &currTmResource);
            if(rc != GT_OK)
            {
                return rc;
            }
        }

        newTmBwMbps = PRV_CPSS_DXCH_PP_MAC(devNum)->portGroupsExtraInfo.groupResorcesStatus.trafficManagerCumBWMbps + speedValueMbps;

        newTmResource.txdmaCreditValue                    = prvCpssDxChBobkTxdmaScdmaTxQDescriptorCreditTmArr         [coreClockIndex][newTmBwMbps / 1000];
        newTmResource.txfifoHeaderCounterThresholdScdma   = prvCpssDxChBobkTxdmaScdmaTxFifoHeaderCreditThresholdTmArr [coreClockIndex][newTmBwMbps / 1000];
        newTmResource.txfifoPayloadCounterThresholdScdma  = prvCpssDxChBobkTxdmaScdmaTxFifoPayloadCreditThresholdTmArr[coreClockIndex][newTmBwMbps / 1000];
        newTmResource.txfifoScdmaPayloadThreshold         = prvCpssDxChBobkTxFifoScdmaPayloadThresholdTmArr           [coreClockIndex][newTmBwMbps / 1000];
        newTmResource.txfifoScdmaShiftersOutgoingBusWidth = 6; /*Tx FIFO TM port (73) is always use 512 bit width, static*/
        newTmResource.rxdmaScdmaIncomingBusWidth          = rxdmaScdmaIncomingBusWidth;
        newTmResource.ethTxfifoOutgoingBusWidth           = txfifoScdmaShiftersOutgoingBusWidth;
        newTmResource.ethTxfifoScdmaPayloadThreshold      = 0xA0;

        rc = prvCpssDxChCaelumTmPortResourseConfigSet(devNum, portNum, &newTmResource);
        if(rc != GT_OK)
        {
            return rc;
        }

        /* Update resource DB with new TM BW */
        PRV_CPSS_DXCH_PP_MAC(devNum)->portGroupsExtraInfo.groupResorcesStatus.trafficManagerCumBWMbps += speedValueMbps;

        if(PRV_CPSS_DXCH_PP_MAC(devNum)->portGroupsExtraInfo.groupResorcesStatus.trafficManagerCumBWMbps != 0)
        {

            /* delete old resources of TM , check new TM resources , if available add them, otherwise restore old */

            rc = prvCpssDxChPortResourcesConfigDbDelete(devNum,dpIndexTxDma,currTmResource.txdmaCreditValue,currTmResource.txfifoHeaderCounterThresholdScdma,currTmResource.txfifoPayloadCounterThresholdScdma);
            if(GT_OK != rc)
            {
                return rc;
            }

            rc = prvCpssDxChPortResourcesConfigDbAvailabilityCheck(devNum, dpIndexTxDma, newTmResource.txdmaCreditValue, newTmResource.txfifoHeaderCounterThresholdScdma, newTmResource.txfifoPayloadCounterThresholdScdma);
            if(GT_OK != rc)
            {
                /* restore previos state */
                rc1 = prvCpssDxChPortResourcesConfigDbAdd(devNum,dpIndexTxDma,currTmResource.txdmaCreditValue,currTmResource.txfifoHeaderCounterThresholdScdma,currTmResource.txfifoPayloadCounterThresholdScdma);
                if(GT_OK != rc1 )
                {
                    return rc1;
                }
                return rc;
            }

        }

        rc = prvCpssDxChPortResourcesConfigDbAdd(devNum,dpIndexTxDma,newTmResource.txdmaCreditValue,newTmResource.txfifoHeaderCounterThresholdScdma,newTmResource.txfifoPayloadCounterThresholdScdma);
        return rc;
    }

    rc = prvCpssDxChPortResourcesConfigDbAvailabilityCheck(devNum, dpIndexTxDma, txdmaCreditValue, txfifoHeaderCounterThresholdScdma, txfifoPayloadCounterThresholdScdma);
    if(GT_OK != rc)
    {
        return rc;
    }

    /*
        1. TXDMA desc credits – each DMA, according to its speed, requires a certain amount of descriptors
           allocated space inside the TXDMA to be able to support FWS (desc_credits_scdma%p).

        TXDMA 1
        Register:   <TXDMA1_IP> TxDMA IP Units/TxDMA Per SCDMA Configurations/FIFOs Thresholds Configurations SCDMA %p Reg 1
        Fields:     BITS 0-8: Descriptor Credits SCDMA %p
        Limitation: SUM(DescriptorCreditsScdma_cc {PortSpeed,CoreFreq}) <= 144

    */
    rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                         PRV_CAELUM_REG_FIELDS_TXDMA_DESC_CREDITS_SCDMA_E,
                                         &regAddr, &fieldOffset, &fieldLen);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDrvHwPpSetRegField(devNum, regAddr, fieldOffset, fieldLen, txdmaCreditValue);
    if(GT_OK != rc)
    {
        return rc;
    }


    /*
        2. TXFIFO header and payload credits – each DMA, according to its speed, 
           requires a certain amount of space allocated inside the TXDMA for both 
           headers and payload to achieve FWS and avoid under-runs 

        TXDMA 1
        Register:   <TXDMA1_IP> TxDMA IP Units/TxDMA Per SCDMA Configurations/TxFIFO Counters Configurations SCDMA %p
        Fields:     BITS 0-9: TxFIFO Header Counter Threshold SCDMA %p
                    BITS 10-19: TxFIFO Payload Counter Threshold SCDMA %p
        Limitation: SUM(Header {PortSpeed,CoreFreq}) <= 363
                    SUM(Payload {PortSpeed,CoreFreq}) <= 447

    */
    rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                         PRV_CAELUM_REG_FIELDS_TXDMA_SCDMA_TXFIFO_HEADER_THRESHOLD_E,
                                         &regAddr, &fieldOffset, &fieldLen);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDrvHwPpSetRegField(devNum, regAddr, fieldOffset, fieldLen, txfifoHeaderCounterThresholdScdma);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                         PRV_CAELUM_REG_FIELDS_TXDMA_SCDMA_TXFIFO_PAYLOAD_THRESHOLD_E,
                                         &regAddr, &fieldOffset, &fieldLen);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDrvHwPpSetRegField(devNum, regAddr, fieldOffset, fieldLen, txfifoPayloadCounterThresholdScdma);
    if(GT_OK != rc)
    {
        return rc;
    }

    /*
        3. Payload Threshold – to avoid under-runs due to variance in the 
           latency of read responses from the MPPM – the TXFIFO is required
           to start transmitting the packet only after reaching a certain
           threshold. Each DMA speeds require a different threshold
           (scdma_%p_payload_threshold).
    */
    rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                         PRV_CAELUM_REG_FIELDS_TXFIFO_SCDMA_PAYLOAD_THRESHOLD_E,
                                         &regAddr, &fieldOffset, &fieldLen);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDrvHwPpSetRegField(devNum, regAddr, fieldOffset, fieldLen, txfifoScdmaPayloadThreshold);
    if(GT_OK != rc)
    {
        return rc;
    }

    /*
        4. TXFIFO Outgoing Bus Width – Each transmit DMA speed requires 
           a different interface width to the GOP (outgoing_bus_%p_width).

        TXDMA 1
        Register:   <TXFIFO1_IP> TxFIFO IP Units/TxFIFO Shifters Configuration/SCDMA %p Shifters Configuration
        Fields:     BITS 0-2: outgoing_bus_%p_width

        5. RXDMA Incoming Bus Width – Each receive DMA speed requires a different interface width to the GOP.

        TXDMA 1
        Register:   RxDMA IP Units/Single Channel DMA Configurations/SCDMA %n Configuration 0/if_width<<%n>>
        Fields:     BITS 0-2: outgoing_bus_%p_width
    */

    rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                         PRV_CAELUM_REG_FIELDS_TXFIFO_SCDMA_SHIFTERS_OUTGOING_BUS_WIDTH_E,
                                         &regAddr, &fieldOffset, &fieldLen);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDrvHwPpSetRegField(devNum, regAddr, fieldOffset, fieldLen, txfifoScdmaShiftersOutgoingBusWidth);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                         PRV_CAELUM_REG_FIELDS_RXDMA_SCDMA_INCOMING_BUS_WIDTH_E,
                                         &regAddr, &fieldOffset, &fieldLen);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDrvHwPpSetRegField(devNum, regAddr, fieldOffset, fieldLen, rxdmaScdmaIncomingBusWidth);
    if(GT_OK != rc)
    {
        return rc;
    }

    /* update DB */
    rc = prvCpssDxChPortResourcesConfigDbAdd(devNum,dpIndexTxDma,txdmaCreditValue,txfifoHeaderCounterThresholdScdma,txfifoPayloadCounterThresholdScdma);
    return rc;
}

/*******************************************************************************
* prvCpssDxChCaelumPortResourcesConfig
*
* DESCRIPTION:
*       Caelum port resourse configuration
*
* APPLICABLE DEVICES:
*       Caelum.
*
* NOT APPLICABLE DEVICES:
*       DxCh1; DxCh1_Diamond; DxCh2; DxCh3; xCat; xCat3; Lion; xCat2; Lion2; Bobcat2; Bobcat3.
*
*
* INPUTS:
*       devNum      - physical device number
*       portNum     - physical port number
*       ifMode      - port interface mode
*       speed       - port interface speed
*
* OUTPUTS:
*       None.
*
* RETURNS:
*       GT_OK                    - on success
*       GT_BAD_PARAM             - on wrong port number, device, ifMode, speed
*       GT_HW_ERROR              - on hardware error
*       GT_NOT_APPLICABLE_DEVICE - on not applicable device
*
* COMMENTS:
*
*******************************************************************************/
GT_STATUS prvCpssDxChCaelumPortResourcesConfig
(
    IN GT_U8                           devNum,
    IN GT_PHYSICAL_PORT_NUM            portNum,
    IN CPSS_PORT_INTERFACE_MODE_ENT    ifMode,
    IN CPSS_PORT_SPEED_ENT             speed
)
{
    GT_STATUS   rc;                 /* return code */

    /*
    if(CPSS_CPU_PORT_NUM_CNS( ifMode == CPSS_PORT_INTERFACE_MODE_NA_E)
    {
        return GT_BAD_PARAM;
    }
    */
    if((speed < CPSS_PORT_SPEED_10_E) || (speed >= CPSS_PORT_SPEED_NA_E))
    {
        return GT_BAD_PARAM;
    }
    /* resources are computed on 1G base , so move the speed to 1G resolution */
    if (speed == CPSS_PORT_SPEED_10_E || speed == CPSS_PORT_SPEED_100_E)
    {
        speed = CPSS_PORT_SPEED_1000_E;
    }

    if(PRV_CPSS_DXCH_CETUS_CHECK_MAC(devNum))
    {
        rc = prvCpssDxChCaelumPortResourcesConfigStatic(devNum, portNum, ifMode, speed);
    }
    else if(PRV_CPSS_DXCH_CAELUM_CHECK_MAC(devNum))
    {
        rc = prvCpssDxChCaelumPortResourcesConfigStatic(devNum, portNum, ifMode, speed);
        CPSS_TBD_BOOKMARK_BOBCAT2_BOBK
#if 0        
        rc = prvCpssDxChCaelumPortResourcesConfigDynamic(devNum, portNum, ifMode, speed);
#endif
    }
    else
    {
        return GT_NOT_APPLICABLE_DEVICE;
    }
    if(rc != GT_OK)
    {
        return rc;
    }





#if 0

    rc = prvCpssDxChCaelumPortResourcesSpeedIndexGet(speed, &speedIndex, &speedValue);
    if(GT_OK != rc)
    {
        return rc;
    }


    /***************************************
        Resource calculation section:
    ****************************************/
    rc = prvCpssDxChCaelumPortResourcesCalculation(devNum, portNum, speed,
            &txdmaCreditValue, &txfifoHeaderCounterThresholdScdma, &txfifoPayloadCounterThresholdScdma);
    if(rc != GT_OK)
    {
        return rc;
    }

    /***************************************
        Limitation check section:
    ****************************************/

    rc = prvCpssDxChCaelumPortResourcesLimitationCheck(devNum, txdmaCreditValue);
    if(rc != GT_OK)
    {
        return rc;
    }





    /****************************************

     ****************************************/
    

    rc = prvCpssDxChPortCaelumRegAddrGet(devNum,portNum,
                                         PRV_CAELUM_REG_FIELDS_TXDMA_DESC_CREDITS_SCDMA_E,
                                         &regAddr, &fieldOffset, &fieldLen);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDrvHwPpSetRegField(devNum, regAddr, fieldOffset, fieldLen, txdmaCreditValue);
    if(GT_OK != rc)
    {
        return rc;
    }


    if(portNum < 48)
    {
        PRV_CPSS_DXCH_PP_MAC(devNum)->portGroupsExtraInfo.groupResorcesStatus.coreOverallSpeedSummary[0] += speedValue;
    }
    else
    {
        PRV_CPSS_DXCH_PP_MAC(devNum)->portGroupsExtraInfo.groupResorcesStatus.coreOverallSpeedSummary[1] += speedValue;
    }
#endif


    return GT_OK;
}


/*******************************************************************************
* prvCpssDxChCaelumPortResourcesInit
*
* DESCRIPTION:
*       Initialize data structure for port resource allocation
*
* APPLICABLE DEVICES:
*       Caelum.
*
* NOT APPLICABLE DEVICES:
*       DxCh1; DxCh1_Diamond; DxCh2; DxCh3; xCat; xCat3; Lion; xCat2; Lion2; Lion3; Bobcat2; Bobcat3.
*
* INPUTS:
*       devNum      - physical device number
*
* OUTPUTS:
*       None
*
* RETURNS:
*       GT_OK             - on success
*       GT_BAD_PARAM      - on wrong port number or device
*       GT_HW_ERROR       - on hardware error
*       GT_NOT_SUPPORTED  - on not supported interface for given port
*       GT_NOT_APPLICABLE_DEVICE - on not applicable device
*
* COMMENTS:
*
*******************************************************************************/
GT_STATUS prvCpssDxChCaelumPortResourcesInit
(
    IN    GT_U8                   devNum
)
{
    GT_STATUS rc;

    PRV_CPSS_DXCH_DEV_CHECK_MAC(devNum);
    /* prvCpssDxChBcat2Resourses[CPSS_PORT_SPEED_NA_E][PRV_BC2_CORE_CLOCK_MAX_IDX_E] =  */

    PRV_CPSS_NOT_APPLICABLE_DEV_CHECK_MAC(devNum, CPSS_CH1_E | CPSS_CH1_DIAMOND_E |
                                                  CPSS_CH2_E | CPSS_CH3_E | CPSS_XCAT_E |
                                                  CPSS_XCAT3_E | CPSS_LION_E | CPSS_LION2_E |CPSS_XCAT2_E | 
                                                  CPSS_BOBCAT3_E);


    if(PRV_CPSS_DXCH_CAELUM_CHECK_MAC(devNum))
    {
        rc = prvCpssDxChPortResourcesConfigDbInit(devNum,
                                                  0,
                                                  PRV_CPSS_DXCH_CAELUM_DP0_TXQ_CREDITS_CNS,
                                                  PRV_CPSS_DXCH_CAELUM_DP0_TXFIFO_HEADERS_CREDITS_CNS,
                                                  PRV_CPSS_DXCH_CAELUM_DP0_TXFIFO_PAYLOAD_CREDITS_CNS);
        if(rc != GT_OK)
        {
            return rc;
        }

        rc = prvCpssDxChPortResourcesConfigDbInit(devNum,
                                                  1,
                                                  PRV_CPSS_DXCH_CAELUM_DP1_TXQ_CREDITS_CNS,
                                                  PRV_CPSS_DXCH_CAELUM_DP1_TXFIFO_HEADERS_CREDITS_CNS,
                                                  PRV_CPSS_DXCH_CAELUM_DP1_TXFIFO_PAYLOAD_CREDITS_CNS);
        if(rc != GT_OK)
        {
            return rc;
        }
    }
    else if(PRV_CPSS_DXCH_CETUS_CHECK_MAC(devNum))
    {
        rc = prvCpssDxChPortResourcesConfigDbInit(devNum,
                                                  0,
                                                  0,
                                                  0,
                                                  0);
        if(rc != GT_OK)
        {
            return rc;
        }

        rc = prvCpssDxChPortResourcesConfigDbInit(devNum,
                                                  1,
                                                  PRV_CPSS_DXCH_CETUS_DP1_TXQ_CREDITS_CNS,
                                                  PRV_CPSS_DXCH_CETUS_DP1_TXFIFO_HEADERS_CREDITS_CNS,
                                                  PRV_CPSS_DXCH_CETUS_DP1_TXFIFO_PAYLOAD_CREDITS_CNS);
        if(rc != GT_OK)
        {
            return rc;
        }
    }
    else
    {
        return GT_NOT_APPLICABLE_DEVICE;
    }

    return GT_OK;
}



/*******************************************************************************
* prvCpssDxChCaelumPortResourcesRelease
*
* DESCRIPTION:
*       Remove resources allocated to the port
*
* APPLICABLE DEVICES:
*       Caelum.
*
* NOT APPLICABLE DEVICES:
*       DxCh1; DxCh1_Diamond; DxCh2; DxCh3; xCat; xCat3; Lion; xCat2; Lion2; Bobcat2.
*
* INPUTS:
*       devNum    - physical device number
*       portNum   - physical port number
*
* OUTPUTS:
*       None
*
* RETURNS:
*       GT_OK             - on success
*       GT_BAD_PARAM      - on wrong port number or device
*       GT_HW_ERROR       - on hardware error
*       GT_NOT_SUPPORTED  - on not supported interface for given port
*       GT_NOT_APPLICABLE_DEVICE - on not applicable device
*
* COMMENTS:
*
*******************************************************************************/
GT_STATUS prvCpssDxChCaelumPortResourcesRelease
(
    IN GT_U8                            devNum,
    IN GT_PHYSICAL_PORT_NUM             portNum
)
{
    GT_STATUS   rc;                 /* return code */
    GT_U32      regAddr;            /* register address */
    GT_U32      fieldOffset;        /* register field offset */
    GT_U32      fieldLen;           /* register field length */
    GT_U32      coreClockIndex;     /* index in clock DB */
    GT_U32      txdmaCreditValue;
    GT_U32      txfifoHeaderCounterThresholdScdma;
    GT_U32      txfifoPayloadCounterThresholdScdma;
    GT_U32      dpIndexTxDma;
    PRV_CPSS_DXCH_PORT_MAP_SHADOW_STC *portMapShadowPtr;
    GT_U32      speedValueMbps;
    GT_U32      speedIndex;
    GT_U32      newTmBwMbps;
    PRV_CPSS_DXCH_CAELUM_PORT_TM_RESOURCE_STC newTmResource;
    PRV_CPSS_DXCH_CAELUM_PORT_TM_RESOURCE_STC currTmResource;


    /* Get Port Mapping DataBase */
    rc = prvCpssDxChPortPhysicalPortMapShadowDBGet(devNum, portNum, /*OUT*/&portMapShadowPtr);
    if(rc != GT_OK)
    {
        return rc;
    }
    dpIndexTxDma = portMapShadowPtr->portMap.txDmaNum >= PRV_CPSS_DXCH_BOBK_DP1_FIRST_PORT_NUM_CNS;


    rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                         PRV_CAELUM_REG_FIELDS_TXDMA_DESC_CREDITS_SCDMA_E,
                                         &regAddr, &fieldOffset, &fieldLen);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDrvHwPpGetRegField(devNum, regAddr, fieldOffset, fieldLen, &txdmaCreditValue);
    if(GT_OK != rc)
    {
        return rc;
    }
    rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                         PRV_CAELUM_REG_FIELDS_TXDMA_SCDMA_TXFIFO_HEADER_THRESHOLD_E,
                                         &regAddr, &fieldOffset, &fieldLen);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDrvHwPpGetRegField(devNum, regAddr, fieldOffset, fieldLen, &txfifoHeaderCounterThresholdScdma);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                         PRV_CAELUM_REG_FIELDS_TXDMA_SCDMA_TXFIFO_PAYLOAD_THRESHOLD_E,
                                         &regAddr, &fieldOffset, &fieldLen);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDrvHwPpGetRegField(devNum, regAddr, fieldOffset, fieldLen, &txfifoPayloadCounterThresholdScdma);
    if(GT_OK != rc)
    {
        return rc;
    }


    /*
        1. In the TXQ - Reset the desc credits counters of the port (Credit_Counters_Reset_%n).
           (not self cleared - after reset should be restored to normal mode)
    */
    rc = prvCpssDxChCaelumPortRegAddrGet(devNum, portNum, 
                                         PRV_CAELUM_REG_FIELDS_TXQ_DQ_TXDMA_CREDIT_COUNTERS_RESET_E,
                                         &regAddr, &fieldOffset, &fieldLen);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDrvHwPpSetRegField(devNum, regAddr, fieldOffset, fieldLen, 1);
    if(GT_OK != rc)
    {
        return rc;
    }

    /* Not self cleared - should be restored to 0 */
    rc = prvCpssDrvHwPpSetRegField(devNum, regAddr, fieldOffset, fieldLen, 0);
    if(GT_OK != rc)
    {
        return rc;
    }

    /*
        2. In the TXDMA - configure TXQ descriptor credits threshold to 0 to avoid 
           sending credits to the TXQ (desc_credits_scdma%p).
    */

    rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                         PRV_CAELUM_REG_FIELDS_TXDMA_DESC_CREDITS_SCDMA_E,
                                         &regAddr, &fieldOffset, &fieldLen);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDrvHwPpSetRegField(devNum, regAddr, fieldOffset, fieldLen, 0);
    if(GT_OK != rc)
    {
        return rc;
    }

    /*
        3. Reset the TXDMA scdma desc credit counter (reset_desc_credits_counter_scdma%p).
           (not self cleared - after reset should be restored to normal mode)
    */
    rc = prvCpssDxChCaelumPortRegAddrGet(devNum,portNum,
                                         PRV_CAELUM_REG_FIELDS_TXDMA_SCDMA_RESET_DESC_CREDITS_COUNTER_E,
                                         &regAddr, &fieldOffset, &fieldLen);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDrvHwPpSetRegField(devNum, regAddr, fieldOffset, fieldLen, 1);
    if(GT_OK != rc)
    {
        return rc;
    }

    rc = prvCpssDrvHwPpSetRegField(devNum, regAddr, fieldOffset, fieldLen, 0);
    if(GT_OK != rc)
    {
        return rc;
    }

    if(portMapShadowPtr->portMap.trafficManagerEn == GT_TRUE)
    {
        /* convert core clock to DB index */
        rc = prvCpssDxChCaelumPortResourcesClockIndexGet(PRV_CPSS_PP_MAC(devNum)->coreClock, &coreClockIndex);
        if(GT_OK != rc)
        {
            return rc;
        }

        rc = prvCpssDxChCaelumPortResourcesSpeedIndexGet(PRV_CPSS_DXCH_PORT_SPEED_MAC(devNum, portMapShadowPtr->portMap.macNum), &speedIndex, &speedValueMbps);
        if(GT_OK != rc)
        {
            return rc;
        }

        rc = prvCpssDxChCaelumTmPortResourseConfigGet(devNum, portNum, &currTmResource);
        if(rc != GT_OK)
        {
            return rc;
        }

        if(PRV_CPSS_DXCH_PP_MAC(devNum)->portGroupsExtraInfo.groupResorcesStatus.trafficManagerCumBWMbps > speedValueMbps)
        {

            newTmBwMbps = PRV_CPSS_DXCH_PP_MAC(devNum)->portGroupsExtraInfo.groupResorcesStatus.trafficManagerCumBWMbps - speedValueMbps;

            newTmResource.txdmaCreditValue                    = prvCpssDxChBobkTxdmaScdmaTxQDescriptorCreditTmArr         [coreClockIndex][newTmBwMbps / 1000];
            newTmResource.txfifoHeaderCounterThresholdScdma   = prvCpssDxChBobkTxdmaScdmaTxFifoHeaderCreditThresholdTmArr [coreClockIndex][newTmBwMbps / 1000];
            newTmResource.txfifoPayloadCounterThresholdScdma  = prvCpssDxChBobkTxdmaScdmaTxFifoPayloadCreditThresholdTmArr[coreClockIndex][newTmBwMbps / 1000];
            newTmResource.txfifoScdmaPayloadThreshold         = prvCpssDxChBobkTxFifoScdmaPayloadThresholdTmArr           [coreClockIndex][newTmBwMbps / 1000];
            newTmResource.txfifoScdmaShiftersOutgoingBusWidth = 6; /*Tx FIFO TM port (73) is always use 512 bit width, static*/
            newTmResource.rxdmaScdmaIncomingBusWidth          = 0;
            newTmResource.ethTxfifoOutgoingBusWidth           = 0;
            newTmResource.ethTxfifoScdmaPayloadThreshold      = 0xA0;

            rc = prvCpssDxChCaelumTmPortResourseConfigSet(devNum, portNum, &newTmResource);
            if(rc != GT_OK)
            {
                return rc;
            }

            rc = prvCpssDxChPortResourcesConfigDbDelete(devNum,dpIndexTxDma,currTmResource.txdmaCreditValue,currTmResource.txfifoHeaderCounterThresholdScdma,currTmResource.txfifoPayloadCounterThresholdScdma);
            if(GT_OK != rc)
            {
                return rc;
            }

            rc = prvCpssDxChPortResourcesConfigDbAdd(devNum,dpIndexTxDma,newTmResource.txdmaCreditValue,newTmResource.txfifoHeaderCounterThresholdScdma,newTmResource.txfifoPayloadCounterThresholdScdma);
            if(GT_OK != rc)
            {
                return rc;
            }

            PRV_CPSS_DXCH_PP_MAC(devNum)->portGroupsExtraInfo.groupResorcesStatus.trafficManagerCumBWMbps -= speedValueMbps;
        }
        else
        {
            newTmResource.txdmaCreditValue                    = 0;
            newTmResource.txfifoHeaderCounterThresholdScdma   = 0;
            newTmResource.txfifoPayloadCounterThresholdScdma  = 0;
            newTmResource.txfifoScdmaPayloadThreshold         = 0;
            newTmResource.txfifoScdmaShiftersOutgoingBusWidth = 6; /*Tx FIFO TM port (73) is always use 512 bit width, static*/
            newTmResource.rxdmaScdmaIncomingBusWidth          = 0;

            rc = prvCpssDxChCaelumTmPortResourseConfigSet(devNum, portNum, &newTmResource);
            if(rc != GT_OK)
            {
                return rc;
            }

            rc = prvCpssDxChPortResourcesConfigDbDelete(devNum,dpIndexTxDma,currTmResource.txdmaCreditValue,currTmResource.txfifoHeaderCounterThresholdScdma,currTmResource.txfifoPayloadCounterThresholdScdma);
            if(GT_OK != rc)
            {
                return rc;
            }

            PRV_CPSS_DXCH_PP_MAC(devNum)->portGroupsExtraInfo.groupResorcesStatus.trafficManagerCumBWMbps = 0;
        }

    }
    else
    {
        /* update DB (DP_1) */
        rc = prvCpssDxChPortResourcesConfigDbDelete(devNum,dpIndexTxDma,txdmaCreditValue,txfifoHeaderCounterThresholdScdma,txfifoPayloadCounterThresholdScdma);
    }

    return GT_OK;
}


/*******************************************************************************
* prvCpssDxChPortCaelumRegAddrGet
*
* DESCRIPTION:
*       Caelum port resourse registers get
*
* APPLICABLE DEVICES:
*       Caelum.
*
* NOT APPLICABLE DEVICES:
*       DxCh1; DxCh1_Diamond; DxCh2; DxCh3; xCat; xCat3; Lion; xCat2; Lion2; Bobcat2; Bobcat3.
*
*
* INPUTS:
*       devNum      - physical device number
*       portNum     - physical port number
*       fieldCode   - port field code name
*
* OUTPUTS:
*       regAddrPtr  - (pointer to) register address
*       fieldOffsetPtr - (pointer to) register field offset
*       fieldLenPtr - (pointer to) register field length
*
* RETURNS:
*       GT_OK                    - on success
*       GT_BAD_PARAM             - on wrong port number, device, ifMode, speed
*       GT_HW_ERROR              - on hardware error
*       GT_NOT_APPLICABLE_DEVICE - on not applicable device
*       GT_BAD_PTR               - on NULL pointer
*
* COMMENTS:
*
*******************************************************************************/
GT_STATUS prvCpssDxChCaelumPortRegAddrGet
(
    IN  GT_U8                       devNum,
    IN  GT_PHYSICAL_PORT_NUM        portNum,
    IN  PRV_CAELUM_REG_FIELDS_ENT   fieldCode,
    OUT GT_U32                      *regAddrPtr,
    OUT GT_U32                      *fieldOffsetPtr,
    OUT GT_U32                      *fieldLenPtr
)
{
    GT_STATUS   rc;                  /* return code */
    GT_U32      dpIndexRxDma;        /* data Path index for RxDMA port */
    GT_U32      dpIndexTxDma;        /* data Path index for TxDMA port */
    GT_U32      dpIndexTxFifo;       /* data Path index for TxFIFO port */
    PRV_CPSS_DXCH_PORT_MAP_SHADOW_STC *portMapShadowPtr;

    CPSS_NULL_PTR_CHECK_MAC(regAddrPtr);
    CPSS_NULL_PTR_CHECK_MAC(fieldOffsetPtr);
    CPSS_NULL_PTR_CHECK_MAC(fieldLenPtr);

    rc = prvCpssDxChPortPhysicalPortMapShadowDBGet(devNum, portNum, /*OUT*/&portMapShadowPtr);
    if(rc != GT_OK)
    {
        return rc;
    }

#ifndef GM_USED
    dpIndexRxDma = portMapShadowPtr->portMap.rxDmaNum >= PRV_CPSS_DXCH_BOBK_DP1_FIRST_PORT_NUM_CNS;
    dpIndexTxDma = portMapShadowPtr->portMap.txDmaNum >= PRV_CPSS_DXCH_BOBK_DP1_FIRST_PORT_NUM_CNS;
    dpIndexTxFifo = portMapShadowPtr->portMap.txDmaNum >= PRV_CPSS_DXCH_BOBK_DP1_FIRST_PORT_NUM_CNS;
#else
    dpIndexRxDma = 0;
    dpIndexTxDma = 0;
    dpIndexTxFifo = 0;
#endif

    switch(fieldCode)
    {
        case PRV_CAELUM_REG_FIELDS_TXQ_Q_PORT_DESC_COUNTER_E:
            PRV_CPSS_DXCH_PORT_DESCR_COUNT_REG_MAC(devNum, portNum, regAddrPtr);
            *fieldOffsetPtr = 0;
            *fieldLenPtr = 14;
            break;
 
        case PRV_CAELUM_REG_FIELDS_TXQ_DQ_TXDMA_PORT_CREDIT_COUNTER_E:

            *regAddrPtr = PRV_DXCH_REG1_UNIT_TXQ_DQ_MAC(devNum).global.creditCounters.txdmaPortCreditCounter[portMapShadowPtr->portMap.txqNum];
            *fieldOffsetPtr = 0;
            *fieldLenPtr = 12;
            break;

        case PRV_CAELUM_REG_FIELDS_TXQ_DQ_TXDMA_CREDIT_COUNTERS_RESET_E:

            *regAddrPtr = PRV_DXCH_REG1_UNIT_TXQ_DQ_MAC(devNum).global.globalDQConfig.creditCountersReset[portMapShadowPtr->portMap.txqNum >> 5];
            *fieldOffsetPtr = portMapShadowPtr->portMap.txqNum % 32;
            *fieldLenPtr = 1;
            break;

        case PRV_CAELUM_REG_FIELDS_TXDMA_DESC_CREDITS_SCDMA_E:
            *regAddrPtr = PRV_DXCH_REG1_UNIT_TXDMA_INDEX_MAC(devNum, dpIndexTxDma).txDMAPerSCDMAConfigs.FIFOsThresholdsConfigsSCDMAReg1[portMapShadowPtr->portMap.txDmaNum];
            *fieldOffsetPtr = 0;
            *fieldLenPtr = 9;
            break;

        case PRV_CAELUM_REG_FIELDS_TXDMA_SCDMA_HEADER_TXFIFO_COUNTER_E:
            *regAddrPtr = PRV_DXCH_REG1_UNIT_TXDMA_INDEX_MAC(devNum, dpIndexTxDma).txDMADebug.informativeDebug.SCDMAStatusReg1[portMapShadowPtr->portMap.txDmaNum];
            *fieldOffsetPtr = 10;
            *fieldLenPtr = 10;
            break;

        case PRV_CAELUM_REG_FIELDS_TXDMA_SCDMA_PAYLOAD_TXFIFO_COUNTER_E:
            *regAddrPtr = PRV_DXCH_REG1_UNIT_TXDMA_INDEX_MAC(devNum, dpIndexTxDma).txDMADebug.informativeDebug.SCDMAStatusReg1[portMapShadowPtr->portMap.txDmaNum];
            *fieldOffsetPtr = 0;
            *fieldLenPtr = 10;
            break;

        case PRV_CAELUM_REG_FIELDS_TXDMA_SCDMA_RESET_DESC_CREDITS_COUNTER_E:
            *regAddrPtr = PRV_DXCH_REG1_UNIT_TXDMA_INDEX_MAC(devNum, dpIndexTxDma).txDMAPerSCDMAConfigs.SCDMAConfigs2[portMapShadowPtr->portMap.txDmaNum];
            *fieldOffsetPtr = 0;
            *fieldLenPtr = 1;
            break;

        case PRV_CAELUM_REG_FIELDS_TXDMA_SCDMA_TXFIFO_HEADER_THRESHOLD_E:
            *regAddrPtr = PRV_DXCH_REG1_UNIT_TXDMA_INDEX_MAC(devNum, dpIndexTxDma).txDMAPerSCDMAConfigs.txFIFOCntrsConfigsSCDMA[portMapShadowPtr->portMap.txDmaNum];
            *fieldOffsetPtr = 0;
            *fieldLenPtr = 10;
            break;

        case PRV_CAELUM_REG_FIELDS_TXDMA_SCDMA_TXFIFO_PAYLOAD_THRESHOLD_E:
            *regAddrPtr = PRV_DXCH_REG1_UNIT_TXDMA_INDEX_MAC(devNum, dpIndexTxDma).txDMAPerSCDMAConfigs.txFIFOCntrsConfigsSCDMA[portMapShadowPtr->portMap.txDmaNum];
            *fieldOffsetPtr = 10;
            *fieldLenPtr = 10;
            break;

        case PRV_CAELUM_REG_FIELDS_TXFIFO_SCDMA_PAYLOAD_THRESHOLD_E:
            *regAddrPtr = PRV_DXCH_REG1_UNIT_TX_FIFO_INDEX_MAC(devNum, dpIndexTxFifo).txFIFOGlobalConfig.SCDMAPayloadThreshold[portMapShadowPtr->portMap.txFifoPortNum];
            *fieldOffsetPtr = 0;
            *fieldLenPtr = 7;
            break;

        case PRV_CAELUM_REG_FIELDS_TXFIFO_SCDMA_SHIFTERS_OUTGOING_BUS_WIDTH_E:
            *regAddrPtr = PRV_DXCH_REG1_UNIT_TX_FIFO_INDEX_MAC(devNum, dpIndexTxFifo).txFIFOShiftersConfig.SCDMAShiftersConf[portMapShadowPtr->portMap.txFifoPortNum];
            *fieldOffsetPtr = 0;
            *fieldLenPtr = 3;
            break;

        case PRV_CAELUM_REG_FIELDS_RXDMA_SCDMA_INCOMING_BUS_WIDTH_E:
            *regAddrPtr = PRV_DXCH_REG1_UNIT_RXDMA_INDEX_MAC(devNum, dpIndexRxDma).singleChannelDMAConfigs.SCDMAConfig0[portMapShadowPtr->portMap.rxDmaNum];
            *fieldOffsetPtr = 0;
            *fieldLenPtr = 3;
            break;

        case PRV_CAELUM_REG_FIELDS_ETH_TXFIFO_OUTGOING_BUS_WIDTH_E:
            *regAddrPtr = PRV_CPSS_DXCH_DEV_REGS_VER1_MAC(devNum)->SIP_ETH_TXFIFO[dpIndexRxDma].txFIFOShiftersConfig.SCDMAShiftersConf[portMapShadowPtr->portMap.rxDmaNum];
            *fieldOffsetPtr = 0;
            *fieldLenPtr = 3;
            break;

        case PRV_CAELUM_REG_FIELDS_ETH_TXFIFO_SCDMA_PAYLOAD_THRESHOLD_E:
            *regAddrPtr = PRV_CPSS_DXCH_DEV_REGS_VER1_MAC(devNum)->SIP_ETH_TXFIFO[dpIndexRxDma].txFIFOGlobalConfig.SCDMAPayloadThreshold[portMapShadowPtr->portMap.rxDmaNum];
            *fieldOffsetPtr = 0;
            *fieldLenPtr = 8;
            break;

        default:
            return GT_BAD_PARAM;
    }

    return GT_OK;
}


